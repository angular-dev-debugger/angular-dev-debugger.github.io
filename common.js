navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(e){});var RTCMultiConnection=function(i,l){var e;function h(s,e){function a(e){return!e.audio&&!e.video&&!e.screen&&e.data}var t="";t+="?userid="+s.userid,t+="&sessionid="+s.sessionid,t+="&msgEvent="+s.socketMessageEvent,t+="&socketCustomEvent="+s.socketCustomEvent,t+="&autoCloseEntireSession="+!!s.autoCloseEntireSession,!0===s.session.broadcast&&(t+="&oneToMany=true"),t+="&maxParticipantsAllowed="+s.maxParticipantsAllowed,s.enableScalableBroadcast&&(t+="&enableScalableBroadcast=true",t+="&maxRelayLimitPerUser="+(s.maxRelayLimitPerUser||2)),t+="&extra="+JSON.stringify(s.extra||{}),s.socketCustomParameters&&(t+=s.socketCustomParameters);try{io.sockets={}}catch(s){}if(s.socketURL||(s.socketURL="/"),"/"!=s.socketURL.substr(s.socketURL.length-1,1))throw'"socketURL" MUST end with a slash.';s.enableLogs&&s.socketURL;try{s.socket=io(s.socketURL+t)}catch(e){s.socket=io.connect(s.socketURL+t,s.socketOptions)}var c=s.multiPeersHandler;function d(e,t){s.peersBackup[e]||(s.peersBackup[e]={userid:e,extra:{}}),s.peersBackup[e].extra=t}s.socket.on("extra-data-updated",function(e,t){s.peers[e]&&(s.peers[e].extra=t,s.onExtraDataUpdated({userid:e,extra:t}),d(e,t))}),s.socket.on(s.socketMessageEvent,function e(t){if(t.remoteUserId==s.userid)if(s.peers[t.sender]&&s.peers[t.sender].extra!=t.message.extra&&(s.peers[t.sender].extra=t.extra,s.onExtraDataUpdated({userid:t.sender,extra:t.extra}),d(t.sender,t.extra)),t.message.streamSyncNeeded&&s.peers[t.sender]){var n=s.streamEvents[t.message.streamid];if(!n||!n.stream)return;var o=t.message.action;if("ended"===o||"inactive"===o||"stream-removed"===o)return s.peersBackup[n.userid]&&(n.extra=s.peersBackup[n.userid].extra),void s.onstreamended(n);var i="both"!=t.message.type?t.message.type:null;"function"==typeof n.stream[o]&&n.stream[o](i)}else if("dropPeerConnection"!==t.message){if(t.message.allParticipants)return-1===t.message.allParticipants.indexOf(t.sender)&&t.message.allParticipants.push(t.sender),void t.message.allParticipants.forEach(function(e){c[s.peers[e]?"renegotiatePeer":"createNewPeer"](e,{localPeerSdpConstraints:{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:a(s.session)})});if(t.message.newParticipant){if(t.message.newParticipant==s.userid)return;if(s.peers[t.message.newParticipant])return;c.createNewPeer(t.message.newParticipant,t.message.userPreferences||{localPeerSdpConstraints:{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:a(s.session)})}else if(t.message.readyForOffer&&(s.attachStreams.length&&(s.waitingForLocalMedia=!1),s.waitingForLocalMedia))setTimeout(function(){e(t)},1);else if(t.message.newParticipationRequest&&t.sender!==s.userid){s.peers[t.sender]&&s.deletePeer(t.sender);var r={extra:t.extra||{},localPeerSdpConstraints:t.message.remotePeerSdpConstraints||{OfferToReceiveAudio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.sdpConstraints.mandatory.OfferToReceiveVideo},remotePeerSdpConstraints:t.message.localPeerSdpConstraints||{OfferToReceiveAudio:s.session.oneway?!!s.session.audio:s.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:s.session.oneway?!!s.session.video||!!s.session.screen:s.sdpConstraints.mandatory.OfferToReceiveVideo},isOneWay:void 0!==t.message.isOneWay?t.message.isOneWay:!!s.session.oneway||"one-way"===s.direction,isDataOnly:void 0!==t.message.isDataOnly?t.message.isDataOnly:a(s.session),dontGetRemoteStream:void 0!==t.message.isOneWay?t.message.isOneWay:!!s.session.oneway||"one-way"===s.direction,dontAttachLocalStream:!!t.message.dontGetRemoteStream,connectionDescription:t,successCallback:function(){}};s.onNewParticipant(t.sender,r)}else{if(t.message.changedUUID&&s.peers[t.message.oldUUID]&&(s.peers[t.message.newUUID]=s.peers[t.message.oldUUID],delete s.peers[t.message.oldUUID]),t.message.userLeft)return c.onUserLeft(t.sender),void(t.message.autoCloseEntireSession&&s.leave());c.addNegotiatedMessage(t.message,t.sender)}}else s.deletePeer(t.sender)});var n=!1;s.socket.resetProps=function(){n=!1},s.socket.on("connect",function(){n||(n=!0,s.enableLogs,setTimeout(function(){s.socket.emit("extra-data-updated",s.extra)},1e3),e&&e(s.socket))}),s.socket.on("disconnect",function(e){s.onSocketDisconnect(e)}),s.socket.on("error",function(e){s.onSocketError(e)}),s.socket.on("user-disconnected",function(e){e!==s.userid&&(s.onUserStatusChanged({userid:e,status:"offline",extra:s.peers[e]&&s.peers[e].extra||{}}),s.deletePeer(e))}),s.socket.on("user-connected",function(e){e!==s.userid&&s.onUserStatusChanged({userid:e,status:"online",extra:s.peers[e]&&s.peers[e].extra||{}})}),s.socket.on("closed-entire-session",function(e,t){s.leave(),s.onEntireSessionClosed({sessionid:e,userid:e,extra:t})}),s.socket.on("userid-already-taken",function(e,t){s.onUserIdAlreadyTaken(e,t)}),s.socket.on("logs",function(e){s.enableLogs}),s.socket.on("number-of-broadcast-viewers-updated",function(e){s.onNumberOfBroadcastViewersUpdated(e)}),s.socket.on("set-isInitiator-true",function(e){e==s.sessionid&&(s.isInitiator=!0)})}function m(i){var r=this,o=["getAllParticipants","getLength","selectFirst","streams","send","forEach"];function s(){i.fbr=new FileBufferReader,i.fbr.onProgress=function(e){i.onFileProgress(e)},i.fbr.onBegin=function(e){i.onFileStart(e)},i.fbr.onEnd=function(e){i.onFileEnd(e)}}i.peers={getLength:function(){var e=0;for(var t in this)-1==o.indexOf(t)&&e++;return e},selectFirst:function(){var e;for(var t in this)-1==o.indexOf(t)&&(e=this[t]);return e},getAllParticipants:function(e){var t=[];for(var n in this)-1==o.indexOf(n)&&n!=e&&t.push(n);return t},forEach:function(t){this.getAllParticipants().forEach(function(e){t(i.peers[e])})},send:function(t,e){var n=this;if(!c(t.size)&&!c(t.type)){if(i.enableFileSharing)return void r.shareFile(t,e);"string"!=typeof t&&(t=JSON.stringify(t))}if("text"===t.type||t instanceof ArrayBuffer||t instanceof DataView){if("text"===t.type&&(t=JSON.stringify(t)),e){var o=i.peers[e];if(o)return o.channels.length?void o.channels.forEach(function(e){e.send(t)}):(i.peers[e].createDataChannel(),i.renegotiate(e),void setTimeout(function(){n.send(t,e)},3e3))}this.getAllParticipants().forEach(function(e){if(!n[e].channels.length)return i.peers[e].createDataChannel(),i.renegotiate(e),void setTimeout(function(){n[e].channels.forEach(function(e){e.send(t)})},3e3);n[e].channels.forEach(function(e){e.send(t)})})}else N.send({text:t,channel:this,connection:i,remoteUserId:e})}},this.uuid=i.userid,this.getLocalConfig=function(e,n,t){return{streamsToShare:(t=t||{}).streamsToShare||{},rtcMultiConnection:i,connectionDescription:t.connectionDescription,userid:n,localPeerSdpConstraints:t.localPeerSdpConstraints,remotePeerSdpConstraints:t.remotePeerSdpConstraints,dontGetRemoteStream:!!t.dontGetRemoteStream,dontAttachLocalStream:!!t.dontAttachLocalStream,renegotiatingPeer:!!t.renegotiatingPeer,peerRef:t.peerRef,channels:t.channels||[],onLocalSdp:function(e){r.onNegotiationNeeded(e,n)},onLocalCandidate:function(e){(e=u.processCandidates(i,e))&&r.onNegotiationNeeded(e,n)},remoteSdp:e,onDataChannelMessage:function(e){if(!i.fbr&&i.enableFileSharing&&s(),"string"!=typeof e&&i.enableFileSharing){var t=this;e instanceof ArrayBuffer||e instanceof DataView?i.fbr.convertToObject(e,function(e){t.onDataChannelMessage(e)}):e.readyForNextChunk?i.fbr.getNextChunk(e,function(t,e){i.peers[n].channels.forEach(function(e){e.send(t)})},n):e.chunkMissing?i.fbr.chunkMissing(e):i.fbr.addChunk(e,function(e){i.peers[n].peer.channel.send(e)})}else r.onDataChannelMessage(e,n)},onDataChannelError:function(e){r.onDataChannelError(e,n)},onDataChannelOpened:function(e){r.onDataChannelOpened(e,n)},onDataChannelClosed:function(e){r.onDataChannelClosed(e,n)},onRemoteStream:function(e){i.peers[n]&&i.peers[n].streams.push(e),r.onGettingRemoteMedia(e,n)},onRemoteStreamRemoved:function(e){r.onRemovingRemoteMedia(e,n)},onPeerStateChanged:function(e){r.onPeerStateChanged(e),"new"===e.iceConnectionState&&r.onNegotiationStarted(n,e),"connected"===e.iceConnectionState&&r.onNegotiationCompleted(n,e),-1!==e.iceConnectionState.search(/closed|failed/gi)&&(r.onUserLeft(n),r.disconnectWith(n))}}},this.createNewPeer=function(e,t){if(!(i.maxParticipantsAllowed<=i.getAllParticipants().length)){if(t=t||{},i.isInitiator&&i.session.audio&&"two-way"===i.session.audio&&!t.streamsToShare&&(t.isOneWay=!1,t.isDataOnly=!1,t.session=i.session),!t.isOneWay&&!t.isDataOnly)return t.isOneWay=!0,void this.onNegotiationNeeded({enableMedia:!0,userPreferences:t},e);t=i.setUserPreferences(t,e);var n=this.getLocalConfig(null,e,t);i.peers[e]=new d(n)}},this.createAnsweringPeer=function(e,t,n){n=i.setUserPreferences(n||{},t);var o=this.getLocalConfig(e,t,n);i.peers[t]=new d(o)},this.renegotiatePeer=function(e,t,n){if(i.peers[e]){(t=t||{}).renegotiatingPeer=!0,t.peerRef=i.peers[e].peer,t.channels=i.peers[e].channels;var o=this.getLocalConfig(n,e,t);i.peers[e]=new d(o)}else i.enableLogs},this.replaceTrack=function(t,n,o){if(!i.peers[n])throw"This peer ("+n+") does not exist.";var e=i.peers[n].peer;e.getSenders&&"function"==typeof e.getSenders&&e.getSenders().length?e.getSenders().forEach(function(e){o&&"video"===e.track.kind&&(i.peers[n].peer.lastVideoTrack=e.track,e.replaceTrack(t)),o||"audio"!==e.track.kind||(i.peers[n].peer.lastAudioTrack=e.track,e.replaceTrack(t))}):this.renegotiatePeer(n)},this.onNegotiationNeeded=function(e,t){},this.addNegotiatedMessage=function(e,t){if(e.type&&e.sdp)return"answer"==e.type&&i.peers[t]&&i.peers[t].addRemoteSdp(e),"offer"==e.type&&(e.renegotiatingPeer?this.renegotiatePeer(t,null,e):this.createAnsweringPeer(e,t)),void i.enableLogs;if(e.candidate)return i.peers[t]&&i.peers[t].addRemoteCandidate(e),void i.enableLogs;if(e.enableMedia){i.session=e.userPreferences.session||i.session,i.session.oneway&&i.attachStreams.length&&(i.attachStreams=[]),e.userPreferences.isDataOnly&&i.attachStreams.length&&(i.attachStreams.length=[]);var n={};i.attachStreams.forEach(function(e){n[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),e.userPreferences.streamsToShare=n,r.onNegotiationNeeded({readyForOffer:!0,userPreferences:e.userPreferences},t)}e.readyForOffer&&i.onReadyForOffer(t,e.userPreferences)},this.onGettingRemoteMedia=function(e,t){},this.onRemovingRemoteMedia=function(e,t){},this.onGettingLocalMedia=function(e){},this.onLocalMediaError=function(e,t){i.onMediaError(e,t)},this.shareFile=function(e,n){s(),i.fbr.readAsArrayBuffer(e,function(t){var e=i.getAllParticipants();n&&(e=[n]),e.forEach(function(e){i.fbr.getNextChunk(t,function(t){i.peers[e].channels.forEach(function(e){e.send(t)})},e)})},{userid:i.userid,chunkSize:"Firefox"===DetectRTC.browser.name?15e3:i.chunkSize||0})};var n=new L(i);this.onDataChannelMessage=function(e,t){n.receive(JSON.parse(e),t,i.peers[t]?i.peers[t].extra:{})},this.onDataChannelClosed=function(e,t){e.userid=t,e.extra=i.peers[t]?i.peers[t].extra:{},i.onclose(e)},this.onDataChannelError=function(e,t){e.userid=t,event.extra=i.peers[t]?i.peers[t].extra:{},i.onerror(e)},this.onDataChannelOpened=function(e,t){i.peers[t].channels.length?i.peers[t].channels=[e]:(i.peers[t].channels.push(e),i.onopen({userid:t,extra:i.peers[t]?i.peers[t].extra:{},channel:e}))},this.onPeerStateChanged=function(e){i.onPeerStateChanged(e)},this.onNegotiationStarted=function(e,t){},this.onNegotiationCompleted=function(e,t){},this.getRemoteStreams=function(e){return e=e||i.peers.getAllParticipants()[0],i.peers[e]?i.peers[e].streams:[]}}function r(e,t,n){if("undefined"!=typeof CustomEvent){var o=new CustomEvent(t,{arguments:n,__exposedProps__:n});e.dispatchEvent(o)}}function v(t,n){n.stream&&n.stream&&n.stream.addEventListener&&(n.stream.addEventListener("mute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.muteType,video:"video"===e.muteType},t.onmute(e)},!1),n.stream.addEventListener("unmute",function(e){(e=t.streamEvents[n.streamid]).session={audio:"audio"===e.unmuteType,video:"video"===e.unmuteType},t.onunmute(e)},!1))}function g(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",n=0,o=e.length;n<o;n++)t+=e[n].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function y(n,t,o){if(o.autoCreateMediaElement){var e=!1;k(n,"video").length||n.isVideo||n.isScreen||(e=!0),"Firefox"===DetectRTC.browser.name&&(o.session.video||o.session.screen)&&(e=!1);var i=document.createElement(e?"audio":"video");if(i.setAttribute("autoplay",!0),i.setAttribute("hidden",!0),"Firefox"===DetectRTC.browser.name){var r="ended";"oninactive"in i&&(r="inactive"),i.addEventListener(r,function(){if(currentUserMediaRequest.remove(n.idInstance),"local"===n.type){r="ended","oninactive"in n&&(r="inactive"),D.onSyncNeeded(n.streamid,r),o.attachStreams.forEach(function(e,t){n.streamid===e.streamid&&delete o.attachStreams[t]});var t=[];o.attachStreams.forEach(function(e){e&&t.push(e)}),o.attachStreams=t;var e=o.streamEvents[n.streamid];if(e)return void o.onstreamended(e);this.parentNode&&this.parentNode.removeChild(this)}},!1)}var s=i.play();if(void 0!==s){var a=!1;setTimeout(function(){a||(a=!0,t(i))},1e3),s.then(function(){a||(a=!0,t(i))}).catch(function(e){a||(a=!0,t(i))})}else t(i)}else t({})}function w(e,t){window.removeEventListener(e,t),window.addEventListener(e,t,!1)}function a(e){var t=[];return e.forEach(function(e){e&&t.push(e)}),t}function b(e){return!e.audio&&!e.video&&!e.screen&&e.data}function c(e){return void 0===e}(e="undefined"!=typeof global?global:null)&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},"undefined"==typeof document&&(e.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""}};return e},document.addEventListener=document.removeEventListener=e.addEventListener=e.removeEventListener=function(){},e.HTMLVideoElement=e.HTMLMediaElement=function(){}),"undefined"==typeof io&&(e.io=function(){return{on:function(e,t){t=t||function(){},"connect"===e&&t()},emit:function(e,t,n){n=n||function(){},"open-room"!==e&&"join-room"!==e||n(!0,t.sessionid,null)}}}),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:"",origin:"self"}),"undefined"==typeof screen&&(e.screen={width:0,height:0}),"undefined"==typeof URL&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=global),function(){var e,t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if("object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var n=process.versions.node.toString().replace("v","");t="Nodejs/"+n+" (NodeOS) AppleWebKit/"+n+" (KHTML, like Gecko) Nodejs/"+n+" Nodejs/"+n}e="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:t,getUserMedia:function(){}},e.window=global),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}));var a=window.navigator;void 0!==a?(void 0!==a.webkitGetUserMedia&&(a.getUserMedia=a.webkitGetUserMedia),void 0!==a.mozGetUserMedia&&(a.getUserMedia=a.mozGetUserMedia)):a={getUserMedia:function(){},userAgent:t};var o=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(a.userAgent||""),c=!(-1===a.userAgent.indexOf("Edge")||!a.msSaveOrOpenBlob&&!a.msSaveBlob),d=!!window.opera||0<=a.userAgent.indexOf(" OPR/"),u=void 0!==window.InstallTrigger,p=/^((?!chrome|android).)*safari/i.test(a.userAgent),f=!!window.chrome&&!d,l="undefined"!=typeof document&&!!document.documentMode&&!c;function i(e,t){var n=0,o=!1,i=window.setInterval(function(){e()&&(window.clearInterval(i),t(o)),50<n++&&(window.clearInterval(i),t(o=!0))},10)}var r,s,h={Android:function(){return a.userAgent.match(/Android/i)},BlackBerry:function(){return a.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return a.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return a.userAgent.match(/Opera Mini/i)},Windows:function(){return a.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}},m="Unknown OS",v="Unknown OS Version",g=function(){for(var e,t=a.appVersion,n=a.userAgent,o="-",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=i[r];r++)if(e.r.test(n)){o=e.s;break}var s="-";switch(/Windows/.test(o)&&(/Windows (.*)/.test(o)&&(s=/Windows (.*)/.exec(o)[1]),o="Windows"),o){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(s=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(s=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(s=(s=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+s[2]+"."+(0|s[3]))}return{osName:o,osVersion:s}}();g&&g.osName&&"-"!=g.osName?(m=g.osName,v=g.osVersion):h.any()&&"Android"==(m=h.getOsName())&&(v=!!(s=(r=(r||a.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&s[1]);var y="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===m&&y&&(m="Nodejs",v=process.versions.node.toString().replace("v",""));var w=!1,b=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!w&&e in document.createElement("canvas")&&(w=!0),!b&&e in document.createElement("video")&&(b=!0))});var C=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,S=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,k=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,x=[],T=[],R=[],E=[];a.mediaDevices&&a.mediaDevices.enumerateDevices&&(a.enumerateDevices=function(e){var t=a.mediaDevices.enumerateDevices();t&&t.then?a.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var A=!1;(void 0!==Q&&"getSources"in Q||a.mediaDevices&&a.mediaDevices.enumerateDevices)&&(A=!0);var P=!1,O=!1,M=!1,D=!1,B=!1;var L=window.DetectRTC||{};L.browser=function(){a.appVersion;var e,t,n,o=a.userAgent,i=a.appName,r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10);if(p&&!f&&-1!==o.indexOf("CriOS")&&(f=!(p=!1)),d){i="Opera";try{s=(r=a.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",s=0}}else l?(r=0<(t=o.indexOf("rv:"))?o.substring(t+3):(t=o.indexOf("MSIE"),o.substring(t+5)),i="IE"):f?(t=o.indexOf("Chrome"),i="Chrome",r=o.substring(t+7)):p?(t=o.indexOf("Safari"),i="Safari",r=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(r=o.substring(t+8)),-1!==a.userAgent.indexOf("Version/")&&(r=a.userAgent.split("Version/")[1].split(" ")[0])):u?(t=o.indexOf("Firefox"),i="Firefox",r=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(i=o.substring(e,t),r=o.substring(t+1),i.toLowerCase()===i.toUpperCase()&&(i=a.appName));return c&&(i="Edge",r=a.userAgent.split("Edge/")[1]),-1!==(n=r.search(/[; \)]/))&&(r=r.substring(0,n)),s=parseInt(""+r,10),isNaN(s)&&(r=""+parseFloat(a.appVersion),s=parseInt(a.appVersion,10)),{fullVersion:r,version:s,name:i,isPrivateBrowsing:!1}}(),function(){var n;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){n=!1},function(e){n=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var t;try{(t=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){n=!0}void 0===n&&i(function(){return"done"===t.readyState},function(e){e||(n=!t.result)})}else if(function(){var e=window.navigator.userAgent.toLowerCase();if(0!==e.indexOf("msie")||0!==e.indexOf("trident")){var t=/(?:msie|rv:)\s?([\d\.]+)/.exec(e);return t&&10<=parseInt(t[1],10)}}()){n=!1;try{window.indexedDB||(n=!0)}catch(e){n=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){n=!0}void 0===n&&(n=!1,window.localStorage.removeItem("test"))}}catch(e){n=!1}i(function(){return void 0!==n},function(e){var t;t=n,L.browser.isPrivateBrowsing=!!t})}(),L.browser["is"+L.browser.name]=!0,L.osName=m,L.osVersion=v,"object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"];var N=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){N||e in window&&(N=!0)}),L.isWebRTCSupported=N,L.isORTCSupported="undefined"!=typeof RTCIceGatherer;var U=!1;(L.browser.isChrome&&35<=L.browser.version||L.browser.isFirefox&&34<=L.browser.version||L.browser.isEdge&&17<=L.browser.version||"Android"===L.osName&&L.browser.isChrome)&&(U=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(L.browser.isChrome||L.browser.isEdge||L.browser.isOpera)||L.browser.isFirefox)&&(U=!1),L.isScreenCapturingSupported=U;var I={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){I.isSupported||e in window&&(I.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(I.isCreateMediaStreamSourceSupported=!0))}),L.isAudioContextSupported=I.isSupported,L.isCreateMediaStreamSourceSupported=I.isCreateMediaStreamSourceSupported;var F=!1;L.browser.isChrome&&31<L.browser.version&&(F=!0),L.isRtpDataChannelsSupported=F;var q=!1;(L.browser.isFirefox&&28<L.browser.version||L.browser.isChrome&&25<L.browser.version||L.browser.isOpera&&11<=L.browser.version)&&(q=!0),L.isSctpDataChannelsSupported=q,L.isMobileDevice=o;var W=!1;(a.getUserMedia||a.mediaDevices&&a.mediaDevices.getUserMedia)&&(W=!0),L.browser.isChrome&&46<=L.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(W="Requires HTTPs"),"Nodejs"===L.osName&&(W=!1),L.isGetUserMediaSupported=W;var j,V,_,H="";screen.width&&(H+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:"")),L.displayResolution=H,L.displayAspectRatio=((j=screen.width)/(_=function e(t,n){return 0==n?t:e(n,t%n)}(j,V=screen.height))/(V/_)).toFixed(2),L.isCanvasSupportsStreamCapturing=w,L.isVideoSupportsStreamCapturing=b,"Chrome"==L.browser.name&&53<=L.browser.version&&(L.isCanvasSupportsStreamCapturing||(L.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),L.isVideoSupportsStreamCapturing||(L.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),L.DetectLocalIPAddress=function(t,e){if(L.isWebRTCSupported){var n=!0,o=!0;!function(i,e){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var r={},t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!t){var n=document.getElementById("iframe");if(!n)return;var o=n.contentWindow;t=o.RTCPeerConnection||o.mozRTCPeerConnection||o.webkitRTCPeerConnection}if(t){var s=null;"Chrome"===L.browser&&L.browser.version<58&&(s={optional:[{RtpDataChannels:!0}]});var a=new t({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},s);if(e&&(a.addStream?a.addStream(e):a.addTrack&&e.getTracks()[0]&&a.addTrack(e.getTracks()[0],e)),a.onicecandidate=function(e){e.candidate&&e.candidate.candidate?c(e.candidate.candidate):c()},!e)try{a.createDataChannel("sctp",{})}catch(i){}L.isPromisesSupported?a.createOffer().then(function(e){a.setLocalDescription(e).then(d)}):a.createOffer(function(e){a.setLocalDescription(e,d,function(){})},function(){})}}function c(e){if(e){var t=S.exec(e);if(t){var n=t[1],o=e.match(C);void 0===r[n]&&i(n,o,!0),r[n]=!0}}else i()}function d(){a.localDescription.sdp.split("\n").forEach(function(e){e&&0===e.indexOf("a=candidate:")&&c(e)})}}(function(e){e?e.match(C)?t("Local: "+e,n=!1,o):e.match(k)?t("Public: "+e,n,o=!1):t("Public: "+e,n,o):t()},e)}},L.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,L.isWebSocketsBlocked=!L.isWebSocketsSupported,"Nodejs"===L.osName&&(L.isWebSocketsSupported=!0,L.isWebSocketsBlocked=!1),L.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){L.isWebSocketsBlocked=!1,t=(new Date).getTime(),n.send("ping")},n.onmessage=function(){L.WebsocketLatency=(new Date).getTime()-t+"ms",e(),n.close(),n=null},n.onerror=function(){L.isWebSocketsBlocked=!0,e()}}catch(t){L.isWebSocketsBlocked=!0,e()}},L.load=function(e){!function(t){if(A)if(!a.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(a.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!a.enumerateDevices&&a.enumerateDevices&&(a.enumerateDevices=a.enumerateDevices.bind(a)),a.enumerateDevices){x=[],T=[],R=[],B=D=M=O=P=!(E=[]);var o={};a.enumerateDevices(function(e){e.forEach(function(e){var t={};for(var n in e)try{"function"!=typeof e[n]&&(t[n]=e[n])}catch(e){}o[t.deviceId+t.label+t.kind]||("audio"===t.kind&&(t.kind="audioinput"),"video"===t.kind&&(t.kind="videoinput"),t.deviceId||(t.deviceId=t.id),t.id||(t.id=t.deviceId),t.label?("videoinput"!==t.kind||B||(B=!0),"audioinput"!==t.kind||D||(D=!0)):(t.isCustomLabel=!0,"videoinput"===t.kind?t.label="Camera "+(E.length+1):"audioinput"===t.kind?t.label="Microphone "+(T.length+1):"audiooutput"===t.kind?t.label="Speaker "+(R.length+1):t.label="Please invoke getUserMedia once.",void 0!==L&&L.browser.isChrome&&46<=L.browser.version&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(t.label="HTTPs is required to get label of this "+t.kind+" device.")),"audioinput"===t.kind&&(P=!0,-1===T.indexOf(t)&&T.push(t)),"audiooutput"===t.kind&&(O=!0,-1===R.indexOf(t)&&R.push(t)),"videoinput"===t.kind&&(M=!0,-1===E.indexOf(t)&&E.push(t)),x.push(t),o[t.deviceId+t.label+t.kind]=t)}),void 0!==L&&(L.MediaDevices=x,L.hasMicrophone=P,L.hasSpeakers=O,L.hasWebcam=M,L.isWebsiteHasWebcamPermissions=B,L.isWebsiteHasMicrophonePermissions=D,L.audioInputDevices=T,L.audioOutputDevices=R,L.videoInputDevices=E),t&&t()})}else t&&t();else t&&t()}(e=e||function(){})},L.MediaDevices=void 0!==x?x:[],L.hasMicrophone=P,L.hasSpeakers=O,L.hasWebcam=M,L.isWebsiteHasWebcamPermissions=B,L.isWebsiteHasMicrophonePermissions=D,L.audioInputDevices=T,L.audioOutputDevices=R,L.videoInputDevices=E;var G=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(G=!0),L.isSetSinkIdSupported=G;var z=!1;L.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(z=!0):L.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(z=!0),L.isRTPSenderReplaceTracksSupported=z;var X=!1;L.browser.isFirefox&&38<L.browser.version&&(X=!0),L.isRemoteStreamProcessingSupported=X;var J=!1;void 0!==Q&&"applyConstraints"in Q.prototype&&(J=!0),L.isApplyConstraintsSupported=J;var K=!1;L.browser.isFirefox&&43<=L.browser.version&&(K=!0),L.isMultiMonitorScreenCapturingSupported=K,L.isPromisesSupported=!!("Promise"in window),L.version="1.3.9",void 0===L&&(window.DetectRTC={});var Y=window.MediaStream;void 0===Y&&"undefined"!=typeof webkitMediaStream&&(Y=webkitMediaStream),L.MediaStream=void 0!==Y&&"function"==typeof Y&&Object.keys(Y.prototype),L.MediaStreamTrack=void 0!==Q&&Object.keys(Q.prototype);var $=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;L.RTCPeerConnection=void 0!==$&&Object.keys($.prototype),window.DetectRTC=L,"undefined"!=typeof module&&(module.exports=L),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return L})}(),"undefined"!=typeof cordova&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Crosswalk")&&(DetectRTC.isMobileDevice=!0,DetectRTC.browser.name="Chrome"),window.addEventListener||(window.addEventListener=function(e,t,n){e.attachEvent&&e.attachEvent("on"+t,n)}),window.attachEventListener=function(e,t,n,o){e.addEventListener(t,n,o)};var C=window.MediaStream;function S(e,t){return!(e.session.audio&&"two-way"===e.session.audio||("Firefox"!==DetectRTC.browser.name||!1===t)&&("Chrome"!==DetectRTC.browser.name||DetectRTC.browser.version<50||!0!==typeof t&&(void 0!==t||!e.session.audio||!e.session.screen||e.session.video||(t=!0,0))))}function k(e,t){return e&&e.getTracks?e.getTracks().filter(function(e){return e.kind===(t||"audio")}):[]}function t(){if("undefined"!=typeof cordova&&void 0!==cordova.plugins&&void 0!==cordova.plugins.iosrtc){var e=cordova.plugins.iosrtc;window.webkitRTCPeerConnection=e.RTCPeerConnection,window.RTCSessionDescription=e.RTCSessionDescription,window.RTCIceCandidate=e.RTCIceCandidate,window.MediaStream=e.MediaStream,window.MediaStreamTrack=e.MediaStreamTrack,navigator.getUserMedia=navigator.webkitGetUserMedia=e.getUserMedia,e.debug.enable("iosrtc*"),"function"==typeof e.selectAudioOutput&&e.selectAudioOutput(window.iOSDefaultAudioOutputDevice||"speaker"),e.registerGlobals()}}void 0===C&&"undefined"!=typeof webkitMediaStream&&(C=webkitMediaStream),void 0!==C&&("stop"in C.prototype||(C.prototype.stop=function(){this.getTracks().forEach(function(e){e.stop()})})),window.iOSDefaultAudioOutputDevice=window.iOSDefaultAudioOutputDevice||"speaker",document.addEventListener("deviceready",t,!1),t();var x,T={};function R(e){return{OfferToReceiveAudio:!!e.OfferToReceiveAudio,OfferToReceiveVideo:!!e.OfferToReceiveVideo}}void 0!==window.RTCPeerConnection?x=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?x=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(x=webkitRTCPeerConnection);var E=window.RTCSessionDescription||window.mozRTCSessionDescription,A=window.RTCIceCandidate||window.mozRTCIceCandidate,Q=window.MediaStreamTrack;function d(o){if(void 0!==window.RTCPeerConnection?x=window.RTCPeerConnection:"undefined"!=typeof mozRTCPeerConnection?x=mozRTCPeerConnection:"undefined"!=typeof webkitRTCPeerConnection&&(x=webkitRTCPeerConnection),E=window.RTCSessionDescription||window.mozRTCSessionDescription,A=window.RTCIceCandidate||window.mozRTCIceCandidate,Q=window.MediaStreamTrack,!x)throw"WebRTC 1.0 (RTCPeerConnection) API are NOT available in this browser.";var n=o.rtcMultiConnection;this.extra=o.remoteSdp?o.remoteSdp.extra:n.extra,this.userid=o.userid,this.streams=[],this.channels=o.channels||[],this.connectionDescription=o.connectionDescription,this.addStream=function(e){n.addStream(e,i.userid)},this.removeStream=function(e){n.removeStream(e,i.userid)};var i=this;o.remoteSdp&&(this.connectionDescription=o.remoteSdp.connectionDescription);var r,s={};T.sdpConstraints=R({OfferToReceiveAudio:!0,OfferToReceiveVideo:!0});var e=!!o.renegotiatingPeer;o.remoteSdp&&(e=!!o.remoteSdp.renegotiatingPeer);var t=[];if(n.attachStreams.forEach(function(e){e&&t.push(e)}),e)r=o.peerRef;else{var a="all";(n.candidates.turn||n.candidates.relay)&&(n.candidates.stun||n.candidates.reflexive||n.candidates.host||(a="relay"));try{var c={iceServers:n.iceServers,iceTransportPolicy:n.iceTransportPolicy||a};void 0!==n.iceCandidatePoolSize&&(c.iceCandidatePoolSize=n.iceCandidatePoolSize),void 0!==n.bundlePolicy&&(c.bundlePolicy=n.bundlePolicy),void 0!==n.rtcpMuxPolicy&&(c.rtcpMuxPolicy=n.rtcpMuxPolicy),n.sdpSemantics&&(c.sdpSemantics=n.sdpSemantics||"unified-plan"),n.iceServers&&n.iceServers.length||(c=null,n.optionalArgument=null),r=new x(c,n.optionalArgument)}catch(o){try{c={iceServers:n.iceServers},r=new x(c)}catch(o){r=new x}}}!r.getRemoteStreams&&r.getReceivers&&(r.getRemoteStreams=function(){var t=new C;return r.getReceivers().forEach(function(e){t.addTrack(e.track)}),[t]}),!r.getLocalStreams&&r.getSenders&&(r.getLocalStreams=function(){var t=new C;return r.getSenders().forEach(function(e){t.addTrack(e.track)}),[t]}),r.onicecandidate=function(e){if(e.candidate)n.trickleIce&&o.onLocalCandidate({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex});else if(!n.trickleIce){var t=r.localDescription;o.onLocalSdp({type:t.type,sdp:t.sdp,remotePeerSdpConstraints:o.remotePeerSdpConstraints||!1,renegotiatingPeer:!!o.renegotiatingPeer||!1,connectionDescription:i.connectionDescription,dontGetRemoteStream:!!o.dontGetRemoteStream,extra:n?n.extra:{},streamsToShare:l})}},t.forEach(function(t){o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.dontGetRemoteStream||o.dontAttachLocalStream||(t=n.beforeAddingStream(t,i))&&(r.getLocalStreams().forEach(function(e){t&&e.id==t.id&&(t=null)}),t&&t.getTracks&&t.getTracks().forEach(function(e){try{r.addTrack(e,t)}catch(e){}}))}),r.oniceconnectionstatechange=r.onsignalingstatechange=function(){var e=i.extra;n.peers[i.userid]&&(e=n.peers[i.userid].extra||e),r&&(o.onPeerStateChanged({iceConnectionState:r.iceConnectionState,iceGatheringState:r.iceGatheringState,signalingState:r.signalingState,extra:e,userid:i.userid}),r&&r.iceConnectionState&&-1!==r.iceConnectionState.search(/closed|failed/gi)&&i.streams instanceof Array&&i.streams.forEach(function(e){var t=n.streamEvents[e.id]||{streamid:e.id,stream:e,type:"remote"};n.onstreamended(t)}))};var d={OfferToReceiveAudio:!!t.length,OfferToReceiveVideo:!!t.length};o.localPeerSdpConstraints&&(d=o.localPeerSdpConstraints),T.sdpConstraints=R(d);var u={};r.ontrack=function(t){if(t&&"track"===t.type)if(t.stream=t.streams[t.streams.length-1],t.stream.id||(t.stream.id=t.track.id),u[t.stream.id]&&"Safari"!==DetectRTC.browser.name)t.track&&(t.track.onended=function(){r&&r.onremovestream(t)});else{u[t.stream.id]=t.stream.id;var e={};o.remoteSdp&&o.remoteSdp.streamsToShare?e=o.remoteSdp.streamsToShare:o.streamsToShare&&(e=o.streamsToShare);var n=e[t.stream.id];n?(t.stream.isAudio=n.isAudio,t.stream.isVideo=n.isVideo,t.stream.isScreen=n.isScreen):(t.stream.isVideo=!!k(t.stream,"video").length,t.stream.isAudio=!t.stream.isVideo,t.stream.isScreen=!1),t.stream.streamid=t.stream.id,s[t.stream.id]=t.stream,o.onRemoteStream(t.stream),t.stream.getTracks().forEach(function(e){e.onended=function(){r&&r.onremovestream(t)}}),t.stream.onremovetrack=function(){r&&r.onremovestream(t)}}},r.onremovestream=function(e){e.stream.streamid=e.stream.id,s[e.stream.id]&&delete s[e.stream.id],o.onRemoteStreamRemoved(e.stream)},"function"!=typeof r.removeStream&&(r.removeStream=function(t){t.getTracks().forEach(function(e){r.removeTrack(e,t)})}),this.addRemoteCandidate=function(e){r.addIceCandidate(new A(e))},this.addRemoteSdp=function(e,t){t=t||function(){},"Safari"!==DetectRTC.browser.name&&(e.sdp=n.processSdp(e.sdp)),r.setRemoteDescription(new E(e)).then(t,function(e){n.enableLogs,t()}).catch(function(e){n.enableLogs,t()})};var p=!0;function f(t){t.binaryType="arraybuffer",t.onmessage=function(e){o.onDataChannelMessage(e.data)},t.onopen=function(){o.onDataChannelOpened(t)},t.onerror=function(e){o.onDataChannelError(e)},t.onclose=function(e){o.onDataChannelClosed(e)},t.internalSend=t.send,t.send=function(e){"open"===t.readyState&&t.internalSend(e)},r.channel=t}o.remoteSdp&&(p=!1),this.createDataChannel=function(){f(r.createDataChannel("sctp",{}))},!0!==n.session.data||e||(p?this.createDataChannel():r.ondatachannel=function(e){f(e.channel)}),this.enableDisableVideoEncoding=function(e){var t;if(r.getSenders().forEach(function(e){t||"video"!==e.track.kind||(t=e)}),t&&t.getParameters){var n=t.getParameters();n.encodings[1]&&(n.encodings[1].active=!!e),n.encodings[2]&&(n.encodings[2].active=!!e),t.setParameters(n)}},o.remoteSdp&&(o.remoteSdp.remotePeerSdpConstraints&&(d=o.remoteSdp.remotePeerSdpConstraints),T.sdpConstraints=R(d),this.addRemoteSdp(o.remoteSdp,function(){h("createAnswer")})),"two-way"!=n.session.audio&&"two-way"!=n.session.video&&"two-way"!=n.session.screen||(T.sdpConstraints=R({OfferToReceiveAudio:"two-way"==n.session.audio||o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio,OfferToReceiveVideo:"two-way"==n.session.video||"two-way"==n.session.screen||o.remoteSdp&&o.remoteSdp.remotePeerSdpConstraints&&o.remoteSdp.remotePeerSdpConstraints.OfferToReceiveAudio}));var l={};function h(e){r[e](T.sdpConstraints).then(function(e){"Safari"!==DetectRTC.browser.name&&(e.sdp=n.processSdp(e.sdp)),r.setLocalDescription(e).then(function(){n.trickleIce&&(o.onLocalSdp({type:e.type,sdp:e.sdp,remotePeerSdpConstraints:o.remotePeerSdpConstraints||!1,renegotiatingPeer:!!o.renegotiatingPeer||!1,connectionDescription:i.connectionDescription,dontGetRemoteStream:!!o.dontGetRemoteStream,extra:n?n.extra:{},streamsToShare:l}),n.onSettingLocalDescription(i))},function(e){n.enableLogs})},function(e){n.enableLogs})}r.getLocalStreams().forEach(function(e){l[e.streamid]={isAudio:!!e.isAudio,isVideo:!!e.isVideo,isScreen:!!e.isScreen}}),p&&h("createOffer"),r.nativeClose=r.close,r.close=function(){if(r){try{r.nativeClose!==r.close&&r.nativeClose()}catch(e){}r=null,i.peer=null}},this.peer=r}var P={removeVPX:function(e){var t=s(e);return e=o(e,"vp9",t,!0),o(e,"vp8",t,!0)},disableNACK:function(e){if(!e||"string"!=typeof e)throw"Invalid arguments.";return(e=(e=(e=e.replace("a=rtcp-fb:126 nack\r\n","")).replace("a=rtcp-fb:126 nack pli\r\n","a=rtcp-fb:126 pli\r\n")).replace("a=rtcp-fb:97 nack\r\n","")).replace("a=rtcp-fb:97 nack pli\r\n","a=rtcp-fb:97 pli\r\n")},prioritize:function(o,e){if(e&&e.getSenders&&e.getSenders().length){if(!o||"string"!=typeof o)throw"Invalid arguments.";e.getSenders().forEach(function(e){for(var t=e.getParameters(),n=0;n<t.codecs.length;n++)if(t.codecs[n].mimeType==o){t.codecs.unshift(t.codecs.splice(n,1));break}e.setParameters(t)})}},removeNonG722:function(e){return e.replace(/m=audio ([0-9]+) RTP\/SAVPF ([0-9 ]*)/g,"m=audio $1 RTP/SAVPF 9")},setApplicationSpecificBandwidth:function(e,t,n){return o=e,(i=t)&&("undefined"!=typeof isFirefox&&isFirefox||(n&&i.screen&&i.screen,i.screen&&n&&(o=(o=o.replace(/b=AS([^\r\n]+\r\n)/g,"")).replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.screen+"\r\n")),(i.audio||i.video)&&(o=o.replace(/b=AS([^\r\n]+\r\n)/g,"")),i.audio&&(o=o.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+i.audio+"\r\n")),i.screen?o=o.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.screen+"\r\n"):i.video&&(o=o.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+i.video+"\r\n")))),o;var o,i},setVideoBitrates:function(e,t){return function(e,t){var n,o=(t=t||{}).min,i=t.max,r=e.split("\r\n"),s=p(r,"a=rtpmap","VP8/90000");if(s&&(n=f(r[s])),!n)return e;var a,c=p(r,"a=rtpmap","rtx/90000");if(c&&(a=f(r[c])),!c)return e;var d=p(r,"a=fmtp:"+a.toString());if(null!==d){var u="\r\n";u+="a=fmtp:"+n+" x-google-min-bitrate="+(o||"228")+"; x-google-max-bitrate="+(i||"228"),r[d]=r[d].concat(u),e=r.join("\r\n")}return e}(e,t)},setOpusAttributes:function(e,t){return function(e,t){t=t||{};var n,o=e.split("\r\n"),i=p(o,"a=rtpmap","opus/48000");if(i&&(n=f(o[i])),!n)return e;var r=p(o,"a=fmtp:"+n.toString());if(null===r)return e;var s="";return s+="; stereo="+(void 0!==t.stereo?t.stereo:"1"),s+="; sprop-stereo="+(void 0!==t["sprop-stereo"]?t["sprop-stereo"]:"1"),void 0!==t.maxaveragebitrate&&(s+="; maxaveragebitrate="+(t.maxaveragebitrate||1048576)),void 0!==t.maxplaybackrate&&(s+="; maxplaybackrate="+(t.maxplaybackrate||1048576)),void 0!==t.cbr&&(s+="; cbr="+(void 0!==t.cbr?t.cbr:"1")),void 0!==t.useinbandfec&&(s+="; useinbandfec="+t.useinbandfec),void 0!==t.usedtx&&(s+="; usedtx="+t.usedtx),void 0!==t.maxptime&&(s+="\r\na=maxptime:"+t.maxptime),o[r]=o[r].concat(s),o.join("\r\n")}(e,t)},preferVP9:function(e){return n(e,"vp9")},preferCodec:n,forceStereoAudio:function(e){for(var t=e.split("\r\n"),n=null,o=0;o<t.length;o++)if(-1!==t[o].search("opus/48000")){var i=extractSdp(t[o],/:(\d+) opus\/48000/i);break}for(o=0;o<t.length;o++)if(-1!==t[o].search("a=fmtp")&&extractSdp(t[o],/a=fmtp:(\d+)/)===i){n=o;break}return null===n?e:(t[n]=t[n].concat("; stereo=1; sprop-stereo=1"),e=t.join("\r\n"))}};function n(e,t){var n=s(e);return!n.videoCodecNumbers||"vp8"===t&&n.vp8LineNumber===n.videoCodecNumbers[0]||"vp9"===t&&n.vp9LineNumber===n.videoCodecNumbers[0]||"h264"===t&&n.h264LineNumber===n.videoCodecNumbers[0]?e:e=o(e,t,n)}function o(e,t,n,o){var i="";if("vp8"===t){if(!n.vp8LineNumber)return e;i=n.vp8LineNumber}if("vp9"===t){if(!n.vp9LineNumber)return e;i=n.vp9LineNumber}if("h264"===t){if(!n.h264LineNumber)return e;i=n.h264LineNumber}var r=n.videoCodecNumbersOriginal.split("SAVPF")[0]+"SAVPF ",s=[i];return o&&(s=[]),n.videoCodecNumbers.forEach(function(e){e!==i&&s.push(e)}),r+=s.join(" "),e.replace(n.videoCodecNumbersOriginal,r)}function s(e){var n={};return e.split("\n").forEach(function(t){0===t.indexOf("m=video")&&(n.videoCodecNumbers=[],t.split("SAVPF")[1].split(" ").forEach(function(e){(e=e.trim())&&e.length&&(n.videoCodecNumbers.push(e),n.videoCodecNumbersOriginal=t)})),-1===t.indexOf("VP8/90000")||n.vp8LineNumber||(n.vp8LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("VP9/90000")||n.vp9LineNumber||(n.vp9LineNumber=t.replace("a=rtpmap:","").split(" ")[0]),-1===t.indexOf("H264/90000")||n.h264LineNumber||(n.h264LineNumber=t.replace("a=rtpmap:","").split(" ")[0])}),n}function p(e,t,n){return function(e,t,n){for(var o=e.length,i=0;i<o;++i)if(0===e[i].indexOf(t)&&(!n||-1!==e[i].toLowerCase().indexOf(n.toLowerCase())))return i;return null}(e,t,n)}function f(e){var t=new RegExp("a=rtpmap:(\\d+) \\w+\\/\\d+"),n=e.match(t);return n&&2===n.length?n[1]:null}window.BandwidthHandler=P;var u={processCandidates:function(e,t){var n=t.candidate,o=e.candidates,i=o.stun,r=o.turn;if(c(o.reflexive)||(i=o.reflexive),c(o.relay)||(r=o.relay),(o.host||!n.match(/typ host/g))&&(r||!n.match(/typ relay/g))&&(i||!n.match(/typ srflx/g))){var s=e.iceProtocols;if((s.udp||!n.match(/ udp /g))&&(s.tcp||!n.match(/ tcp /g)))return e.enableLogs,{candidate:n,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}}}},O={getIceServers:function(e){return[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}]}};function M(r){if(!0!==currentUserMediaRequest.mutex){currentUserMediaRequest.mutex=!0;var s=JSON.stringify(r.localMediaConstraints);if(currentUserMediaRequest.streams[s])i(currentUserMediaRequest.streams[s].stream,!0);else{if(/BB10|BlackBerry/i.test(navigator.userAgent||"")||void 0===navigator.mediaDevices||"function"!=typeof navigator.mediaDevices.getUserMedia)return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,void navigator.getUserMedia(r.localMediaConstraints,function(e){e.streamid=e.streamid||e.id||g(),e.idInstance=s,i(e)},function(e){r.onLocalMediaError(e,r.localMediaConstraints)});if(void 0===navigator.mediaDevices){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var t,n,o=function(){};navigator.mediaDevices={getUserMedia:function(e){return navigator.getUserMedia(e,function(e){e(stream),t=stream},function(e){o(e),n=e}),{then:function(e){if(!t)return{then:function(e){n?e(n):o=e}};e(t)}}}}}if(!0===r.localMediaConstraints.isScreen){if(navigator.mediaDevices.getDisplayMedia)navigator.mediaDevices.getDisplayMedia(r.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||g(),e.idInstance=s,i(e)}).catch(function(e){r.onLocalMediaError(e,r.localMediaConstraints)});else{if(!navigator.getDisplayMedia)throw new Error("getDisplayMedia API is not availabe in this browser.");navigator.getDisplayMedia(r.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||g(),e.idInstance=s,i(e)}).catch(function(e){r.onLocalMediaError(e,r.localMediaConstraints)})}return}navigator.mediaDevices.getUserMedia(r.localMediaConstraints).then(function(e){e.streamid=e.streamid||e.id||g(),e.idInstance=s,i(e)}).catch(function(e){r.onLocalMediaError(e,r.localMediaConstraints)})}}else currentUserMediaRequest.queueRequests.push(r);function i(e,t){var n,o;n=r.localMediaConstraints,o=e,n.mandatory&&n.mandatory.chromeMediaSource||n.mozMediaSource||n.mediaSource?o.isScreen=!0:n.video?o.isVideo=!0:n.audio&&(o.isAudio=!0);var i="ended";"oninactive"in e&&(i="inactive"),e.addEventListener(i,function(){delete currentUserMediaRequest.streams[s],currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.indexOf(r)&&(delete currentUserMediaRequest.queueRequests[currentUserMediaRequest.queueRequests.indexOf(r)],currentUserMediaRequest.queueRequests=a(currentUserMediaRequest.queueRequests))},!1),currentUserMediaRequest.streams[s]={stream:e},currentUserMediaRequest.mutex=!1,currentUserMediaRequest.queueRequests.length&&M(currentUserMediaRequest.queueRequests.shift()),r.onGettingLocalMedia(e,t)}}window.currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[],remove:function(e){this.mutex=!1;var t=this.streams[e];if(t){var n=(t=t.stream).currentUserMediaRequestOptions;this.queueRequests.indexOf(n)&&(delete this.queueRequests[this.queueRequests.indexOf(n)],this.queueRequests=a(this.queueRequests)),this.streams[e].stream=null,delete this.streams[e]}}};var D={setHandlers:function(n,o,i){if(n&&n.addEventListener){if(void 0===o||1==o){var e="ended";"oninactive"in n&&(e="inactive"),n.addEventListener(e,function(){D.onSyncNeeded(this.streamid,e)},!1)}n.mute=function(e,t){e=B(e),void 0!==t&&(o=t),void 0!==e&&"audio"!=e||k(n,"audio").forEach(function(e){e.enabled=!1,i.streamEvents[n.streamid].isAudioMuted=!0}),void 0!==e&&"video"!=e||k(n,"video").forEach(function(e){e.enabled=!1}),void 0!==o&&1!=o||D.onSyncNeeded(n.streamid,"mute",e),i.streamEvents[n.streamid].muteType=e||"both",r(n,"mute",e)},n.unmute=function(e,t){e=B(e),void 0!==t&&(o=t),function(){if(i.streamEvents[n.streamid].mediaElement){var t=i.streamEvents[n.streamid].mediaElement;t.volume=0,function e(t,n,o,i){(i=(i||0)+1)>=n||setTimeout(function(){o(),e(t,n,o,i)},t)}(200,5,function(){try{t.volume+=.2}catch(e){t.volume=1}})}}(),void 0!==e&&"audio"!=e||k(n,"audio").forEach(function(e){e.enabled=!0,i.streamEvents[n.streamid].isAudioMuted=!1}),void 0!==e&&"video"!=e||(k(n,"video").forEach(function(e){e.enabled=!0}),void 0!==e&&"video"==e&&i.streamEvents[n.streamid].isAudioMuted&&function e(t){t=t||0,++t<100&&i.streamEvents[n.streamid].isAudioMuted&&(n.mute("audio"),setTimeout(function(){e(t)},50))}()),void 0!==o&&1!=o||D.onSyncNeeded(n.streamid,"unmute",e),i.streamEvents[n.streamid].unmuteType=e||"both",r(n,"unmute",e)}}},onSyncNeeded:function(e,t,n){}};function B(e){if(e)return"string"==typeof e||void 0===e?e:e.audio&&e.video?null:e.audio?"audio":e.video?"video":void 0}function L(s){var a={};return{receive:function(e,t,n){var o=e.uuid;if(a[o]||(a[o]=[]),a[o].push(e.message),e.last){var i=a[o].join("");e.isobject&&(i=JSON.parse(i));var r={data:i,userid:t,extra:n,latency:(new Date).getTime()-e.sendingTime};s.autoTranslateText?(r.original=r.data,s.Translator.TranslateText(r.data,function(e){r.data=e,s.onmessage(r)})):s.onmessage(r),delete a[o]}}}}var N={send:function(e){var i=e.connection,r=e.channel,s=e.remoteUserId,t=e.text,a=i.chunkSize||1e3,c="",d=!1;"string"!=typeof t&&(d=!0,t=JSON.stringify(t));var u=g(),p=(new Date).getTime();!function e(t,n){var o={type:"text",uuid:u,sendingTime:p};t&&(n=t,o.packets=parseInt(n.length/a)),n.length>a?o.message=n.slice(0,a):(o.message=n,o.last=!0,o.isobject=d),r.send(o,s),(c=n.slice(o.message.length)).length&&setTimeout(function(){e(null,c)},i.chunkInterval||100)}(t)}},U={handle:function(n){var o={};n.onFileStart=function(e){var t=document.createElement("div");if(t.title=e.name,t.innerHTML="<label>0%</label> <progress></progress>",e.remoteUserId&&(t.innerHTML+=" (Sharing with:"+e.remoteUserId+")"),n.filesContainer||(n.filesContainer=document.body||document.documentElement),!e.remoteUserId)return o[e.uuid]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},void(o[e.uuid].progress.max=e.maxChunks);o[e.uuid]||(o[e.uuid]={}),o[e.uuid][e.remoteUserId]={div:t,progress:t.querySelector("progress"),label:t.querySelector("label")},o[e.uuid][e.remoteUserId].progress.max=e.maxChunks},n.onFileProgress=function(e){var t=o[e.uuid];t&&(e.remoteUserId&&!(t=o[e.uuid][e.remoteUserId])||(t.progress.value=e.currentPosition||e.maxChunks||t.progress.max,function(e,t){if(-1!==e.position){var n=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=n+"%"}}(t.progress,t.label)))},n.onFileEnd=function(e){var t=o[e.uuid];if(t&&(!e.remoteUserId||(t=o[e.uuid][e.remoteUserId]))){var n=t.div;-1!=e.type.indexOf("image")?n.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><img src="'+e.url+'" title="'+e.name+'" style="max-width: 80%;">':n.innerHTML='<a href="'+e.url+'" download="'+e.name+'">Download <strong style="color:red;">'+e.name+'</strong> </a><br /><iframe src="'+e.url+'" title="'+e.name+'" style="width: 80%;border: 0;height: inherit;margin-top:1em;"></iframe>'}}}},I={handle:function(s){s.autoTranslateText=!1,s.language="en",s.googKey="AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE",s.Translator={TranslateText:function(e,t){var n=document.createElement("script");n.type="text/javascript";var o=encodeURIComponent(e),i="method"+s.token();window[i]=function(e){e.data&&e.data.translations[0]&&t?t(e.data.translations[0].translatedText):e.error&&"Daily Limit Exceeded"===e.error.message||e.error};var r="https://www.googleapis.com/language/translate/v2?key="+s.googKey+"&target="+(s.language||"en-US")+"&callback=window."+i+"&q="+o;n.src=r,document.getElementsByTagName("head")[0].appendChild(n)},getListOfLanguages:function(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=JSON.parse(n.responseText);if(e&&e.data&&e.data.languages)return void t(e.data.languages);if(e.error&&"Daily Limit Exceeded"===e.error.message)return;if(e.error)return}};var e="https://www.googleapis.com/language/translate/v2/languages?key="+s.googKey+"&target=en";n.open("GET",e,!0),n.send(null)}}}};!function(d){l=l||{useDefaultDevices:!0},d.channel=d.sessionid=(i||location.href.replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g,"").split("\n").join("").split("\r").join(""))+"";var s=new m(d),e={};function u(t){if(d.socketAutoReConnect=!0,d.socket)t&&t(d.socket);else{if(void 0===h)if("undefined"!=typeof FirebaseConnection)window.SocketConnection=FirebaseConnection;else{if("undefined"==typeof PubNubConnection)throw"SocketConnection.js seems missed.";window.SocketConnection=PubNubConnection}new h(d,function(e){t&&t(d.socket)})}}function p(n,o){d.socket.emit("join-room",{sessionid:d.sessionid,session:d.session,mediaConstraints:d.mediaConstraints,sdpConstraints:d.sdpConstraints,streams:t(),extra:d.extra,password:void 0!==d.password&&"object"!=typeof d.password?d.password:""},function(e,t){if(!0===e){if(d.enableLogs,d.peers[d.sessionid])return;s.onNegotiationNeeded(n)}!1===e&&d.enableLogs,o(e,d.sessionid,t)})}function c(n){d.enableLogs,d.waitingForLocalMedia=!1,d.socket.emit("open-room",{sessionid:d.sessionid,session:d.session,mediaConstraints:d.mediaConstraints,sdpConstraints:d.sdpConstraints,streams:t(),extra:d.extra,identifier:d.publicRoomIdentifier,password:void 0!==d.password&&"object"!=typeof d.password?d.password:""},function(e,t){!0===e&&(d.enableLogs,n(e,d.sessionid)),!1===e&&(d.enableLogs,n(e,d.sessionid,t))})}function t(){try{return d.streamEvents.selectAll("local").map(function(e){return{streamid:e.streamid,tracks:e.stream.getTracks().length}})}catch(e){return[]}}function f(e,t){if(d.dontCaptureUserMedia||e.isDataOnly)t();else{var n={};e.localPeerSdpConstraints.OfferToReceiveAudio&&(n.audio=d.mediaConstraints.audio),e.localPeerSdpConstraints.OfferToReceiveVideo&&(n.video=d.mediaConstraints.video);var o=e.session||d.session;o.oneway&&"two-way"!==o.audio&&"two-way"!==o.video&&"two-way"!==o.screen?t():(o.oneway&&o.audio&&"two-way"===o.audio&&(o={audio:!0}),(o.audio||o.video||o.screen)&&(o.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(d)}).then(function(e){e.isScreen=!0,s.onGettingLocalMedia(e),!o.audio&&!o.video||S(d)?t(e):d.invokeGetUserMedia(null,t)},function(e){}):d.invokeGetUserMedia({audio:S(d),video:!0,isScreen:!0},!o.audio&&!o.video||S(d)?t:d.invokeGetUserMedia(null,t)):(o.audio||o.video)&&d.invokeGetUserMedia(null,t,o)))}}function o(e,t){e?(t.audio&&k(e,"audio").forEach(function(e){e.applyConstraints(t.audio)}),t.video&&k(e,"video").forEach(function(e){e.applyConstraints(t.video)})):d.enableLogs}function r(t,e,n){e?s.replaceTrack(t,e,n):d.peers.getAllParticipants().forEach(function(e){s.replaceTrack(t,e,n)})}s.onGettingLocalMedia=function(t,n){if(n=n||function(){},e[t.streamid])n();else{e[t.streamid]=!0;try{t.type="local"}catch(t){}d.setStreamEndHandler(t),y(t,function(e){e.id=t.streamid,e.muted=!0,e.volume=0,-1===d.attachStreams.indexOf(t)&&d.attachStreams.push(t),void 0!==D&&D.setHandlers(t,!0,d),d.streamEvents[t.streamid]={stream:t,type:"local",mediaElement:e,userid:d.userid,extra:d.extra,streamid:t.streamid,isAudioMuted:!0};try{!function(n,o){if(o.stream&&k(o.stream,"audio").length){if(!n||!o)throw"Both arguments are required.";if(n.onspeaking&&n.onsilence){if("undefined"==typeof hark)throw"hark.js not found.";hark(o.stream,{onspeaking:function(){n.onspeaking(o)},onsilence:function(){n.onsilence(o)},onvolumechange:function(e,t){n.onvolumechange&&n.onvolumechange(merge({volume:e,threshold:t},o))}})}}}(d,d.streamEvents[t.streamid]),v(d,d.streamEvents[t.streamid]),d.onstream(d.streamEvents[t.streamid])}catch(e){}n()},d)}},s.onGettingRemoteMedia=function(t,n){try{t.type="remote"}catch(t){}d.setStreamEndHandler(t,"remote-stream"),y(t,function(e){e.id=t.streamid,void 0!==D&&D.setHandlers(t,!1,d),d.streamEvents[t.streamid]={stream:t,type:"remote",userid:n,extra:d.peers[n]?d.peers[n].extra:{},mediaElement:e,streamid:t.streamid},v(d,d.streamEvents[t.streamid]),d.onstream(d.streamEvents[t.streamid])},d)},s.onRemovingRemoteMedia=function(e,t){var n=d.streamEvents[e.streamid];n=n||{stream:e,type:"remote",userid:t,extra:d.peers[t]?d.peers[t].extra:{},streamid:e.streamid,mediaElement:d.streamEvents[e.streamid]?d.streamEvents[e.streamid].mediaElement:null},d.peersBackup[n.userid]&&(n.extra=d.peersBackup[n.userid].extra),d.onstreamended(n),delete d.streamEvents[e.streamid]},s.onNegotiationNeeded=function(e,t,n){n=n||function(){};var o={remoteUserId:t=t||e.remoteUserId,message:e=e||"",sender:d.userid};e.remoteUserId&&e.message&&e.sender&&(o=e),u(function(){d.socket.emit(d.socketMessageEvent,o,n)})},s.onUserLeft=function(e){d.deletePeer(e)},s.disconnectWith=function(e,t){d.socket&&d.socket.emit("disconnect-with",e,t||function(){}),d.deletePeer(e)},d.socketOptions={transport:"polling"},d.openOrJoin=function(e,a){a=a||function(){},d.checkPresence(e,function(e,t){if(e){d.sessionid=t;var n,o,i=!!d.session.oneway,r=b(d.session);o={OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:i?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo};var s={remoteUserId:d.sessionid,message:{newParticipationRequest:!0,isOneWay:i,isDataOnly:r,localPeerSdpConstraints:n,remotePeerSdpConstraints:o},sender:d.userid};f(s.message,function(){p(s,a)})}else d.waitingForLocalMedia=!0,d.isInitiator=!0,d.sessionid=t||d.sessionid,b(d.session)?c(a):d.captureUserMedia(function(){c(a)})})},d.waitingForLocalMedia=!1,d.open=function(e,t){t=t||function(){},d.waitingForLocalMedia=!0,d.isInitiator=!0,d.sessionid=e||d.sessionid,u(function(){b(d.session)?c(t):d.captureUserMedia(function(){c(t)})})},d.peersBackup={},d.deletePeer=function(e){if(e&&d.peers[e]){var t={userid:e,extra:d.peers[e]?d.peers[e].extra:{}};if(d.peersBackup[t.userid]&&(t.extra=d.peersBackup[t.userid].extra),d.onleave(t),d.peers[e]){d.peers[e].streams.forEach(function(e){e.stop()});var n=d.peers[e].peer;if(n&&"closed"!==n.iceConnectionState)try{n.close()}catch(e){}d.peers[e]&&(d.peers[e].peer=null,delete d.peers[e])}}},d.rejoin=function(e){if(!d.isInitiator&&e&&Object.keys(e).length){var t={};d.peers[e.remoteUserId]&&(t=d.peers[e.remoteUserId].extra,d.deletePeer(e.remoteUserId)),e&&e.remoteUserId&&(d.join(e.remoteUserId),d.onReConnecting({userid:e.remoteUserId,extra:t}))}},d.join=function(e,t){d.sessionid=!!e&&(e.sessionid||e.remoteUserId||e)||d.sessionid,d.sessionid+="";var n=!1,o=!1,i=!1,r=!1;if(e&&e.session||!e||"string"==typeof e){var s=e&&e.session||d.session;i=!!s.oneway,r=b(s),o={OfferToReceiveAudio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:d.sdpConstraints.mandatory.OfferToReceiveVideo},n={OfferToReceiveAudio:i?!!d.session.audio:d.sdpConstraints.mandatory.OfferToReceiveAudio,OfferToReceiveVideo:i?!!d.session.video||!!d.session.screen:d.sdpConstraints.mandatory.OfferToReceiveVideo}}var a=function(){};"function"==typeof(t=t||{})&&(a=t,t={}),void 0!==t.localPeerSdpConstraints&&(n=t.localPeerSdpConstraints),void 0!==t.remotePeerSdpConstraints&&(o=t.remotePeerSdpConstraints),void 0!==t.isOneWay&&(i=t.isOneWay),void 0!==t.isDataOnly&&(r=t.isDataOnly);var c={remoteUserId:d.sessionid,message:{newParticipationRequest:!0,isOneWay:i,isDataOnly:r,localPeerSdpConstraints:n,remotePeerSdpConstraints:o},sender:d.userid};return f(c.message,function(){u(function(){p(c,a)})}),c},d.publicRoomIdentifier="",d.getUserMedia=d.captureUserMedia=function(o,i){o=o||function(){};var r=i||d.session;d.dontCaptureUserMedia||b(r)?o():(r.audio||r.video||r.screen)&&(r.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(d)}).then(function(e){if(e.isScreen=!0,s.onGettingLocalMedia(e),!r.audio&&!r.video||S(d))o(e);else{var t={};for(var n in r)"screen"!==n&&(t[n]=r[n]);d.invokeGetUserMedia(i,o,t)}},function(e){}):d.invokeGetUserMedia({audio:S(d),video:!0,isScreen:!0},function(e){if(!r.audio&&!r.video||S(d))o(e);else{var t={};for(var n in r)"screen"!==n&&(t[n]=r[n]);d.invokeGetUserMedia(i,o,t)}}):(r.audio||r.video)&&d.invokeGetUserMedia(i,o,r))},d.onbeforeunload=function(e,t){d.closeBeforeUnload&&(d.peers.getAllParticipants().forEach(function(e){s.onNegotiationNeeded({userLeft:!0},e),d.peers[e]&&d.peers[e].peer&&d.peers[e].peer.close(),delete d.peers[e]}),t||d.closeSocket(),d.isInitiator=!1)},window.ignoreBeforeUnload?d.closeBeforeUnload=!1:(d.closeBeforeUnload=!0,window.addEventListener("beforeunload",d.onbeforeunload,!1)),d.userid=g(),d.changeUserId=function(e,t){t=t||function(){},d.userid=e||g(),d.socket.emit("changed-uuid",d.userid,t)},d.extra={},d.attachStreams=[],d.session={audio:!0,video:!0},d.enableFileSharing=!1,d.bandwidth={screen:!1,audio:!1,video:!1},d.codecs={audio:"opus",video:"VP9"},d.processSdp=function(e){return function(){var e=!1;try{if("undefined"==typeof RTCRtpTransceiver)return;if(!("currentDirection"in RTCRtpTransceiver.prototype))return;var t=new x;try{t.addTransceiver("audio"),e=!0}catch(e){}t.close()}catch(t){e=!1}return e&&function(){var e=!1;try{var t=new x({sdpSemantics:"unified-plan"});try{var n=t.getConfiguration();e="unified-plan"==n.sdpSemantics||(n.sdpSemantics,!1)}catch(t){e=!1}}catch(t){e=!1}return e}()}()||"Safari"===DetectRTC.browser.name||("VP8"===d.codecs.video.toUpperCase()&&(e=P.preferCodec(e,"vp8")),"VP9"===d.codecs.video.toUpperCase()&&(e=P.preferCodec(e,"vp9")),"H264"===d.codecs.video.toUpperCase()&&(e=P.preferCodec(e,"h264")),"G722"===d.codecs.audio&&(e=P.removeNonG722(e)),"Firefox"===DetectRTC.browser.name||((d.bandwidth.video||d.bandwidth.screen)&&(e=P.setApplicationSpecificBandwidth(e,d.bandwidth,!!d.session.screen)),d.bandwidth.video&&(e=P.setVideoBitrates(e,{min:8*d.bandwidth.video*1024,max:8*d.bandwidth.video*1024})),d.bandwidth.audio&&(e=P.setOpusAttributes(e,{maxaveragebitrate:8*d.bandwidth.audio*1024,maxplaybackrate:8*d.bandwidth.audio*1024,stereo:1,maxptime:3})))),e},void 0!==P&&(d.BandwidthHandler=d.CodecsHandler=P),d.mediaConstraints={audio:{mandatory:{},optional:d.bandwidth.audio?[{bandwidth:8*d.bandwidth.audio*1024||1048576}]:[]},video:{mandatory:{},optional:d.bandwidth.video?[{bandwidth:8*d.bandwidth.video*1024||1048576},{facingMode:"user"}]:[{facingMode:"user"}]}},"Firefox"===DetectRTC.browser.name&&(d.mediaConstraints={audio:!0,video:!0}),l.useDefaultDevices||DetectRTC.isMobileDevice||DetectRTC.load(function(){var t,n;if(DetectRTC.MediaDevices.forEach(function(e){"audioinput"===e.kind&&!1!==d.mediaConstraints.audio&&(t=e),"videoinput"===e.kind&&!1!==d.mediaConstraints.video&&(n=e)}),t){if("Firefox"===DetectRTC.browser.name)return void(!0!==d.mediaConstraints.audio?d.mediaConstraints.audio.deviceId=t.id:d.mediaConstraints.audio={deviceId:t.id});1==d.mediaConstraints.audio&&(d.mediaConstraints.audio={mandatory:{},optional:[]}),d.mediaConstraints.audio.optional||(d.mediaConstraints.audio.optional=[]);var e=[{sourceId:t.id}];d.mediaConstraints.audio.optional=e.concat(d.mediaConstraints.audio.optional)}if(n){if("Firefox"===DetectRTC.browser.name)return void(!0!==d.mediaConstraints.video?d.mediaConstraints.video.deviceId=n.id:d.mediaConstraints.video={deviceId:n.id});1==d.mediaConstraints.video&&(d.mediaConstraints.video={mandatory:{},optional:[]}),d.mediaConstraints.video.optional||(d.mediaConstraints.video.optional=[]),e=[{sourceId:n.id}],d.mediaConstraints.video.optional=e.concat(d.mediaConstraints.video.optional)}}),d.sdpConstraints={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},optional:[{VoiceActivityDetection:!1}]},d.sdpSemantics=null,d.iceCandidatePoolSize=null,d.bundlePolicy=null,d.rtcpMuxPolicy=null,d.iceTransportPolicy=null,d.optionalArgument={optional:[{DtlsSrtpKeyAgreement:!0},{googImprovedWifiBwe:!0},{googScreencastMinBitrate:300},{googIPv6:!0},{googDscp:!0},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:85},{googSuspendBelowMinBitrate:!0},{googCpuOveruseDetection:!0}],mandatory:{}},d.iceServers=O.getIceServers(d),d.candidates={host:!0,stun:!0,turn:!0},d.iceProtocols={tcp:!0,udp:!0},d.onopen=function(e){d.enableLogs},d.onclose=function(e){d.enableLogs},d.onerror=function(e){d.enableLogs},d.onmessage=function(e){d.enableLogs},d.send=function(e,t){d.peers.send(e,t)},d.close=d.disconnect=d.leave=function(){d.onbeforeunload(!1,!0)},d.closeEntireSession=function(t){t=t||function(){},d.socket.emit("close-entire-session",function e(){d.getAllParticipants().length?setTimeout(e,100):(d.onEntireSessionClosed({sessionid:d.sessionid,userid:d.userid,extra:d.extra}),d.changeUserId(null,function(){d.close(),t()}))})},d.onEntireSessionClosed=function(e){d.enableLogs},d.onstream=function(e){var t=d.videosContainer;t.insertBefore(e.mediaElement,t.firstChild);var n=e.mediaElement.play();void 0===n?setTimeout(function(){e.mediaElement.play()},2e3):n.catch(function(){}).then(function(){setTimeout(function(){e.mediaElement.play()},2e3)})},d.onstreamended=function(e){e.mediaElement||(e.mediaElement=document.getElementById(e.streamid)),e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},d.direction="many-to-many",d.removeStream=function(t,n){var o;d.attachStreams.forEach(function(e){e.id===t&&(o=e)}),o&&(d.peers.getAllParticipants().forEach(function(e){if(!n||e===n){var t=d.peers[e];try{t.peer.removeStream(o)}catch(e){}}}),d.renegotiate())},d.addStream=function(t,n){if(t.getTracks)return-1===d.attachStreams.indexOf(t)&&(t.streamid||(t.streamid=t.id),d.attachStreams.push(t)),void d.renegotiate(n);function o(e){t.streamCallback&&t.streamCallback(e),d.renegotiate(n)}b(t)?d.renegotiate(n):(t.audio||t.video||t.screen)&&(t.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(d)}).then(function(e){e.isScreen=!0,s.onGettingLocalMedia(e),!t.audio&&!t.video||S(d)?o(e):d.invokeGetUserMedia(null,function(e){o(e)})},function(e){}):d.invokeGetUserMedia({audio:S(d),video:!0,isScreen:!0},function(e){!t.audio&&!t.video||S(d)?o(e):d.invokeGetUserMedia(null,function(e){o(e)})}):(t.audio||t.video)&&d.invokeGetUserMedia(null,o))},d.invokeGetUserMedia=function(n,o,e){e=e||d.session,M({onGettingLocalMedia:function(e){var t=n.video;t&&(t.mediaSource||t.mozMediaSource||t.mandatory&&t.mandatory.chromeMediaSource)&&(e.isScreen=!0),e.isScreen||(e.isVideo=!!k(e,"video").length,e.isAudio=!e.isVideo&&k(e,"audio").length),s.onGettingLocalMedia(e,function(){"function"==typeof o&&o(e)})},onLocalMediaError:function(e,t){s.onLocalMediaError(e,t)},localMediaConstraints:(n=n||d.mediaConstraints)||{audio:!!e.audio&&n.audio,video:!!e.video&&n.video}})},d.applyConstraints=function(t,e){if(Q&&Q.prototype.applyConstraints){var n;if(e)return d.streamEvents[e]&&(n=d.streamEvents[e].stream),void o(n,t);d.attachStreams.forEach(function(e){o(e,t)})}else alert("track.applyConstraints is NOT supported in your browser.")},d.replaceTrack=function(t,n,o){if(t=t||{},x.prototype.getSenders)if(t instanceof Q)r(t,n,o);else{if(t instanceof C)return k(t,"video").length&&r(k(t,"video")[0],n,!0),void(k(t,"audio").length&&r(k(t,"audio")[0],n,!1));if(b(t))throw"connection.replaceTrack requires audio and/or video and/or screen.";(t.audio||t.video||t.screen)&&(t.screen?"Edge"===DetectRTC.browser.name?navigator.getDisplayMedia({video:!0,audio:S(d)}).then(function(e){e.isScreen=!0,s.onGettingLocalMedia(e),!t.audio&&!t.video||S(d)?i(e):d.invokeGetUserMedia(null,i)},function(e){}):d.invokeGetUserMedia({audio:S(d),video:!0,isScreen:!0},!t.audio&&!t.video||S(d)?i:d.invokeGetUserMedia(null,i)):(t.audio||t.video)&&d.invokeGetUserMedia(null,i))}else d.addStream(t);function i(e){d.replaceTrack(e,n,o||t.video||t.screen)}},d.resetTrack=function(e,n){"string"==typeof(e=e||d.getAllParticipants())&&(e=[e]),e.forEach(function(e){var t=d.peers[e].peer;void 0!==n&&!0!==n||!t.lastVideoTrack||d.replaceTrack(t.lastVideoTrack,e,!0),void 0!==n&&!1!==n||!t.lastAudioTrack||d.replaceTrack(t.lastAudioTrack,e,!1)})},d.renegotiate=function(e){e?s.renegotiatePeer(e):d.peers.getAllParticipants().forEach(function(e){s.renegotiatePeer(e)})},d.setStreamEndHandler=function(o,i){if(o&&o.addEventListener&&(i=!!i,!o.alreadySetEndHandler)){o.alreadySetEndHandler=!0;var e="ended";"oninactive"in o&&(e="inactive"),o.addEventListener(e,function(){if(o.idInstance&&currentUserMediaRequest.remove(o.idInstance),!i){var t=[];d.attachStreams.forEach(function(e){e.id!=o.id&&t.push(e)}),d.attachStreams=t}var e=d.streamEvents[o.streamid];if(e=e||{stream:o,streamid:o.streamid,type:i?"remote":"local",userid:d.userid,extra:d.extra,mediaElement:d.streamEvents[o.streamid]?d.streamEvents[o.streamid].mediaElement:null},i&&d.peers[e.userid]){var n=d.peers[e.userid].peer;t=[],n.getRemoteStreams().forEach(function(e){e.id!=o.id&&t.push(e)}),d.peers[e.userid].streams=t}e.userid===d.userid&&"remote"===e.type||(d.peersBackup[e.userid]&&(e.extra=d.peersBackup[e.userid].extra),d.onstreamended(e),delete d.streamEvents[o.streamid])},!1)}},d.onMediaError=function(e,t){d.enableLogs},d.autoCloseEntireSession=!1,d.filesContainer=d.videosContainer=document.body||document.documentElement,d.isInitiator=!1,d.shareFile=s.shareFile,void 0!==U&&U.handle(d),void 0!==I&&I.handle(d),d.token=g,d.onNewParticipant=function(e,t){d.acceptParticipationRequest(e,t)},d.acceptParticipationRequest=function(e,t){t.successCallback&&(t.successCallback(),delete t.successCallback),s.createNewPeer(e,t)},void 0!==D&&(d.StreamsHandler=D),d.onleave=function(e){},d.invokeSelectFileDialog=function(e){var t=new FileSelector;t.accept="*.*",t.selectSingleFile(e)},d.onmute=function(e){if(e&&e.mediaElement)if("both"===e.muteType||"video"===e.muteType){e.mediaElement.src=null;var t=e.mediaElement.pause();void 0!==t?t.then(function(){e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}):e.mediaElement.poster=e.snapshot||"https://cdn.webrtc-experiment.com/images/muted.png"}else"audio"===e.muteType&&(e.mediaElement.muted=!0)},d.onunmute=function(e){e&&e.mediaElement&&e.stream&&("both"===e.unmuteType||"video"===e.unmuteType?(e.mediaElement.poster=null,e.mediaElement.srcObject=e.stream,e.mediaElement.play()):"audio"===e.unmuteType&&(e.mediaElement.muted=!1))},d.onExtraDataUpdated=function(e){e.status="online",d.onUserStatusChanged(e,!0)},d.getAllParticipants=function(e){return d.peers.getAllParticipants(e)},void 0!==D&&(D.onSyncNeeded=function(t,n,o){d.peers.getAllParticipants().forEach(function(e){s.onNegotiationNeeded({streamid:t,action:n,streamSyncNeeded:!0,type:o||"both"},e)})}),d.connectSocket=function(e){u(e)},d.closeSocket=function(){try{io.sockets={}}catch(e){}d.socket&&("function"==typeof d.socket.disconnect&&d.socket.disconnect(),"function"==typeof d.socket.resetProps&&d.socket.resetProps(),d.socket=null)},d.getSocket=function(e){return e||d.enableLogs,e=e||function(){},d.socket?e(d.socket):u(function(){e(d.socket)}),d.socket},d.getRemoteStreams=s.getRemoteStreams;var a=["selectFirst","selectAll","forEach"];if(d.streamEvents={selectFirst:function(e){return d.streamEvents.selectAll(e)[0]},selectAll:function(o){"local"==(o=o||{local:!0,remote:!0,isScreen:!0,isAudio:!0,isVideo:!0})&&(o={local:!0}),"remote"==o&&(o={remote:!0}),"screen"==o&&(o={isScreen:!0}),"audio"==o&&(o={isAudio:!0}),"video"==o&&(o={isVideo:!0});var i=[];return Object.keys(d.streamEvents).forEach(function(e){var t=d.streamEvents[e];if(-1===a.indexOf(e)){var n=!0;o.local&&"local"===t.type&&(n=!1),o.remote&&"remote"===t.type&&(n=!1),o.isScreen&&t.stream.isScreen&&(n=!1),o.isVideo&&t.stream.isVideo&&(n=!1),o.isAudio&&t.stream.isAudio&&(n=!1),o.userid&&t.userid===o.userid&&(n=!1),!1===n&&i.push(t)}}),i}},d.socketURL="/",d.socketMessageEvent="RTCMultiConnection-Message",d.socketCustomEvent="RTCMultiConnection-Custom-Message",d.DetectRTC=DetectRTC,d.setCustomSocketEvent=function(e){e&&(d.socketCustomEvent=e),d.socket&&d.socket.emit("set-custom-socket-event-listener",d.socketCustomEvent)},d.getNumberOfBroadcastViewers=function(e,t){d.socket&&e&&t&&d.socket.emit("get-number-of-users-in-specific-broadcast",e,t)},d.onNumberOfBroadcastViewersUpdated=function(e){d.enableLogs&&d.isInitiator},d.onUserStatusChanged=function(e,t){d.enableLogs},d.getUserMediaHandler=M,d.multiPeersHandler=s,d.enableLogs=!0,d.setCustomSocketHandler=function(e){void 0!==h&&(h=e)},d.chunkSize=4e4,d.maxParticipantsAllowed=1e3,d.disconnectWith=s.disconnectWith,d.checkPresence=function(e,o){e=e||d.sessionid,"SSEConnection"!==h.name?d.socket?d.socket.emit("check-presence",e+"",function(e,t,n){d.enableLogs,o(e,t,n)}):d.connectSocket(function(){d.checkPresence(e,o)}):SSEConnection.checkPresence(e,function(e,t,n){if(!d.socket)return e||(d.userid=t),void d.connectSocket(function(){o(e,t,n)});o(e,t)})},d.onReadyForOffer=function(e,t){d.multiPeersHandler.createNewPeer(e,t)},d.setUserPreferences=function(e){return d.dontAttachStream&&(e.dontAttachLocalStream=!0),d.dontGetRemoteStream&&(e.dontGetRemoteStream=!0),e},d.updateExtraData=function(){d.socket.emit("extra-data-updated",d.extra)},d.enableScalableBroadcast=!1,d.maxRelayLimitPerUser=3,d.dontCaptureUserMedia=!1,d.dontAttachStream=!1,d.dontGetRemoteStream=!1,d.onReConnecting=function(e){d.enableLogs},d.beforeAddingStream=function(e){return e},d.beforeRemovingStream=function(e){return e},"undefined"!=typeof isChromeExtensionAvailable&&(d.checkIfChromeExtensionAvailable=isChromeExtensionAvailable),"undefined"!=typeof isFirefoxExtensionAvailable&&(d.checkIfChromeExtensionAvailable=isFirefoxExtensionAvailable),"undefined"!=typeof getChromeExtensionStatus&&(d.getChromeExtensionStatus=getChromeExtensionStatus),d.modifyScreenConstraints=function(e){return e},d.onPeerStateChanged=function(e){d.enableLogs&&e.iceConnectionState.search(/closed|failed/gi)},d.isOnline=!0,w("online",function(){d.isOnline=!0}),w("offline",function(){d.isOnline=!1}),d.isLowBandwidth=!1,navigator&&navigator.connection&&navigator.connection.type&&(d.isLowBandwidth=-1!==navigator.connection.type.toString().toLowerCase().search(/wifi|cell/g),d.isLowBandwidth)){if(d.bandwidth={audio:!1,video:!1,screen:!1},d.mediaConstraints.audio&&d.mediaConstraints.audio.optional&&d.mediaConstraints.audio.optional.length){var n=[];d.mediaConstraints.audio.optional.forEach(function(e){void 0===e.bandwidth&&n.push(e)}),d.mediaConstraints.audio.optional=n}d.mediaConstraints.video&&d.mediaConstraints.video.optional&&d.mediaConstraints.video.optional.length&&(n=[],d.mediaConstraints.video.optional.forEach(function(e){void 0===e.bandwidth&&n.push(e)}),d.mediaConstraints.video.optional=n)}d.getExtraData=function(e,o){if(!e)throw"remoteUserId is required.";if("function"!=typeof o)return d.peers[e]?d.peers[e].extra:d.peersBackup[e]?d.peersBackup[e].extra:{};d.socket.emit("get-remote-user-extra-data",e,function(e,t,n){o(e,t,n)})},l.autoOpenOrJoin&&d.openOrJoin(d.sessionid),d.onUserIdAlreadyTaken=function(e,t){d.close(),d.closeSocket(),d.isInitiator=!1,d.userid=d.token(),d.join(d.sessionid),d.enableLogs},d.trickleIce=!0,d.version="3.6.9",d.onSettingLocalDescription=function(e){d.enableLogs},d.resetScreen=function(){sourceId=null,DetectRTC&&DetectRTC.screen&&delete DetectRTC.screen.sourceId,currentUserMediaRequest={streams:[],mutex:!1,queueRequests:[]}},d.autoCreateMediaElement=!0,d.password=null,d.setPassword=function(e,t){t=t||function(){},d.socket?d.socket.emit("set-password",e,t):(d.password=e,t(!0,d.sessionid,null))},d.onSocketDisconnect=function(e){d.enableLogs},d.onSocketError=function(e){d.enableLogs},d.errors={ROOM_NOT_AVAILABLE:"Room not available",INVALID_PASSWORD:"Invalid password",USERID_NOT_AVAILABLE:"User ID does not exist",ROOM_PERMISSION_DENIED:"Room permission denied",ROOM_FULL:"Room full",DID_NOT_JOIN_ANY_ROOM:"Did not join any room yet",INVALID_SOCKET:"Invalid socket",PUBLIC_IDENTIFIER_MISSING:"publicRoomIdentifier is required",INVALID_ADMIN_CREDENTIAL:"Invalid username or password attempted"}}(this)};"undefined"!=typeof module&&(module.exports=exports=RTCMultiConnection),"function"==typeof define&&define.amd&&define("RTCMultiConnection",[],function(){return RTCMultiConnection}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return i={},n.m=o=[function(e,t,n){"use strict";function o(e,t){"object"===(void 0===e?"undefined":c(e))&&(t=e,e=void 0),t=t||{};var n,o=d(e),i=o.source,r=o.id,s=o.path,a=f[r]&&s in f[r].nsps;return n=t.forceNew||t["force new connection"]||!1===t.multiplex||a?(p("ignoring socket cache for %s",i),u(i,t)):(f[r]||(p("new io instance for %s",i),f[r]=u(i,t)),f[r]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=n(1),i=n(7),u=n(12),p=n(3)("socket.io-client");e.exports=t=o;var f=t.managers={};t.protocol=i.protocol,t.connect=o,t.Manager=n(12),t.Socket=n(36)},function(e,t,n){"use strict";var i=n(2),r=n(3)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(r("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),r("parse %s",e),n=i(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var a=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,n=e.indexOf("["),o=e.indexOf("]");-1!=n&&-1!=o&&(e=e.substring(0,n)+e.substring(n,o).replace(/:/g,";")+e.substring(o,e.length));for(var i=a.exec(e||""),r={},s=14;s--;)r[c[s]]=i[s]||"";return-1!=n&&-1!=o&&(r.source=t,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r}},function(n,r,o){(function(t){function e(){var e;try{e=r.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(r=n.exports=o(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},r.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff),t){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,n)}},r.save=function(e){try{null==e?r.storage.removeItem("debug"):r.storage.debug=e}catch(e){}},r.load=e,r.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},r.enable(e())}).call(r,o(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(t){if(d===setTimeout)return setTimeout(t,0);if((d===n||!d)&&setTimeout)return d=setTimeout,setTimeout(t,0);try{return d(t,0)}catch(e){try{return d.call(null,t,0)}catch(e){return d.call(this,t,0)}}}function r(){h&&f&&(h=!1,f.length?l=f.concat(l):m=-1,l.length&&s())}function s(){if(!h){var e=i(r);h=!0;for(var t=l.length;t;){for(f=l,l=[];++m<t;)f&&f[m].run();m=-1,t=l.length}f=null,h=!1,function(t){if(u===clearTimeout)return clearTimeout(t);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function c(){}var d,u,p=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:n}catch(e){d=n}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(e){u=o}}();var f,l=[],h=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new a(e,t)),1!==l.length||h||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,c,t){function n(e){function o(){if(o.enabled){var i=o,e=+new Date,t=e-(a||e);i.diff=t,i.prev=a,i.curr=e,a=e;for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];r[0]=c.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var s=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;s++;var n=c.formatters[t];if("function"==typeof n){var o=r[s];e=n.call(i,o),r.splice(s,1),s--}return e}),c.formatArgs.call(i,r),(o.log||c.log||console.log.bind(console)).apply(i,r)}}var a;return o.namespace=e,o.enabled=c.enabled(e),o.useColors=c.useColors(),o.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return c.colors[Math.abs(n)%c.colors.length]}(e),o.destroy=i,"function"==typeof c.init&&c.init(o),c.instances.push(o),o}function i(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}(c=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){c.enable("")},c.enable=function(e){c.save(e),c.names=[],c.skips=[];var t,n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(t=0;t<c.instances.length;t++){var i=c.instances[t];i.enabled=c.enabled(i.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=c.skips.length;t<n;t++)if(c.skips[t].test(e))return!1;for(t=0,n=c.names.length;t<n;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=t(6),c.instances=[],c.names=[],c.skips=[],c.formatters={}},function(e,t){function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=36e5,a=864e5;e.exports=function(e,t){t=t||{};var n,o,i=typeof e;if("string"==i&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"==i&&!1===isNaN(e))return t.long?r(o=e,a,"day")||r(o,s,"hour")||r(o,6e4,"minute")||r(o,1e3,"second")||o+" ms":a<=(n=e)?Math.round(n/a)+"d":s<=n?Math.round(n/s)+"h":6e4<=n?Math.round(n/6e4)+"m":1e3<=n?Math.round(n/1e3)+"s":n+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,a,t){function n(){}function r(e){var t=""+e.type;if(a.BINARY_EVENT!==e.type&&a.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===n)return m;t+=n}return u("encoded %j as %s",e,t),t}function o(e,i){f.removeBlobs(e,function(e){var t=f.deconstructPacket(e),n=r(t.packet),o=t.buffers;o.unshift(n),i(o)})}function i(){this.reconstructor=null}function s(e){var t=0,n={type:Number(e.charAt(0))};if(null==a.types[n.type])return d("unknown packet type "+n.type);if(a.BINARY_EVENT===n.type||a.BINARY_ACK===n.type){for(var o="";"-"!==e.charAt(++t)&&(o+=e.charAt(t),t!=e.length););if(o!=Number(o)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(t+1))for(n.nsp="";++t;){if(","===(r=e.charAt(t)))break;if(n.nsp+=r,t===e.length)break}else n.nsp="/";var i=e.charAt(t+1);if(""!==i&&Number(i)==i){for(n.id="";++t;){var r;if(null==(r=e.charAt(t))||Number(r)!=r){--t;break}if(n.id+=e.charAt(t),t===e.length)break}n.id=Number(n.id)}if(e.charAt(++t)){var s=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!(!1!==s&&(n.type===a.ERROR||l(s))))return d("invalid payload");n.data=s}return u("decoded %s as %j",e,n),n}function c(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:a.ERROR,data:"parser error: "+e}}var u=t(3)("socket.io-parser"),p=t(8),f=t(9),l=t(10),h=t(11);a.protocol=4,a.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],a.CONNECT=0,a.DISCONNECT=1,a.EVENT=2,a.ACK=3,a.ERROR=4,a.BINARY_EVENT=5,a.BINARY_ACK=6,a.Encoder=n,a.Decoder=i;var m=a.ERROR+'"encode error"';n.prototype.encode=function(e,t){(u("encoding packet %j",e),a.BINARY_EVENT===e.type||a.BINARY_ACK===e.type)?o(e,t):t([r(e)])},p(i.prototype),i.prototype.add=function(e){var t;if("string"==typeof e)t=s(e),a.BINARY_EVENT===t.type||a.BINARY_ACK===t.type?(this.reconstructor=new c(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!h(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},i.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length!==this.reconPack.attachments)return null;var t=f.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function o(e){if(e)return function(e){for(var t in o.prototype)e[t]=o.prototype[t];return e}(e)}(e.exports=o).prototype.on=o.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},o.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},o.prototype.off=o.prototype.removeListener=o.prototype.removeAllListeners=o.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o,i=0;i<n.length;i++)if((o=n[i])===t||o.fn===t){n.splice(i,1);break}return this},o.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var o=0,i=(n=n.slice(0)).length;o<i;++o)n[o].apply(this,t);return this},o.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},o.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var u=n(10),p=n(11),o=Object.prototype.toString,f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=function e(t,n){if(!t)return t;if(p(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(u(t)){for(var i=new Array(t.length),r=0;r<t.length;r++)i[r]=e(t[r],n);return i}if("object"!=typeof t||t instanceof Date)return t;i={};for(var s in t)i[s]=e(t[s],n);return i}(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(u(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,a){var c=0,d=e;(function e(t,n,o){if(!t)return t;if(f&&t instanceof Blob||l&&t instanceof File){c++;var i=new FileReader;i.onload=function(){o?o[n]=this.result:d=this.result,--c||a(d)},i.readAsArrayBuffer(t)}else if(u(t))for(var r=0;r<t.length;r++)e(t[r],r,t);else if("object"==typeof t&&!p(t))for(var s in t)e(t[s],s,t)})(d),c||a(d)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return n&&Buffer.isBuffer(e)||o&&(e instanceof ArrayBuffer||i(e))};var n="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,o="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){"use strict";function o(e,t){if(!(this instanceof o))return new o(e,t);e&&"object"===(void 0===e?"undefined":i(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=n(13),r=n(36),s=n(8),a=n(7),d=n(38),u=n(39),p=n(3)("socket.io-client:manager"),f=n(35),l=n(40),h=Object.prototype.hasOwnProperty;(e.exports=o).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},o.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},o.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(o.prototype),o.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},o.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},o.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},o.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},o.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},o.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},o.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},o.prototype.open=o.prototype.connect=function(n,e){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=c(this.uri,this.opts);var t=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=d(t,"open",function(){o.onopen(),n&&n()}),r=d(t,"error",function(e){if(p("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",e),n){var t=new Error("Connection error");t.data=e,n(t)}else o.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;p("connect attempt will timeout after %d",s);var a=setTimeout(function(){p("connect attempt timed out after %d",s),i.destroy(),t.close(),t.emit("error","timeout"),o.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(i),this.subs.push(r),this},o.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(d(e,"data",u(this,"ondata"))),this.subs.push(d(e,"ping",u(this,"onping"))),this.subs.push(d(e,"pong",u(this,"onpong"))),this.subs.push(d(e,"error",u(this,"onerror"))),this.subs.push(d(e,"close",u(this,"onclose"))),this.subs.push(d(this.decoder,"decoded",u(this,"ondecoded")))},o.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},o.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},o.prototype.ondata=function(e){this.decoder.add(e)},o.prototype.ondecoded=function(e){this.emit("packet",e)},o.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},o.prototype.socket=function(e,t){function n(){~f(i.connecting,o)||i.connecting.push(o)}var o=this.nsps[e];if(!o){o=new r(this,e,t),this.nsps[e]=o;var i=this;o.on("connecting",n),o.on("connect",function(){o.id=i.generateId(e)}),this.autoConnect&&n()}return o},o.prototype.destroy=function(e){var t=f(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},o.prototype.packet=function(n){p("writing packet %j",n);var o=this;n.query&&0===n.type&&(n.nsp+="?"+n.query),o.encoding?o.packetBuffer.push(n):(o.encoding=!0,this.encoder.encode(n,function(e){for(var t=0;t<e.length;t++)o.engine.write(e[t],n.options);o.encoding=!1,o.processPacketQueue()}))},o.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},o.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},o.prototype.close=o.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},o.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},o.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(p("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(p("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(p("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},o.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(14),e.exports.parser=n(21)},function(e,t,n){function p(e,t){return this instanceof p?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=a(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),"undefined"!=typeof self&&!this.isReactNative||(t.extraHeaders&&0<Object.keys(t.extraHeaders).length&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new p(e,t)}var o=n(15),i=n(8),f=n(3)("engine.io-client:socket"),r=n(35),s=n(21),a=n(2),c=n(29);(e.exports=p).priorWebsocketSuccess=!1,i(p.prototype),p.protocol=s.protocol,(p.Socket=p).Transport=n(20),p.transports=n(15),p.parser=n(21),p.prototype.createTransport=function(e){f('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new o[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},p.prototype.open=function(){var e;if(this.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},p.prototype.setTransport=function(e){f("setting transport %s",e.name);var t=this;this.transport&&(f("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},p.prototype.probe=function(n){function e(){if(u.onlyBinaryUpgrades){var e=!this.supportsBinary&&u.transport.supportsBinary;d=d||e}d||(f('probe transport "%s" opened',n),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(e){if(!d)if("pong"===e.type&&"probe"===e.data){if(f('probe transport "%s" pong',n),u.upgrading=!0,u.emit("upgrading",c),!c)return;p.priorWebsocketSuccess="websocket"===c.name,f('pausing current transport "%s"',u.transport.name),u.transport.pause(function(){d||"closed"!==u.readyState&&(f("changing transport and sending upgrade packet"),a(),u.setTransport(c),c.send([{type:"upgrade"}]),u.emit("upgrade",c),c=null,u.upgrading=!1,u.flush())})}else{f('probe transport "%s" failed',n);var t=new Error("probe error");t.transport=c.name,u.emit("upgradeError",t)}}))}function o(){d||(d=!0,a(),c.close(),c=null)}function t(e){var t=new Error("probe error: "+e);t.transport=c.name,o(),f('probe transport "%s" failed because of error: %s',n,e),u.emit("upgradeError",t)}function i(){t("transport closed")}function r(){t("socket closed")}function s(e){c&&e.name!==c.name&&(f('"%s" works - aborting "%s"',e.name,c.name),o())}function a(){c.removeListener("open",e),c.removeListener("error",t),c.removeListener("close",i),u.removeListener("close",r),u.removeListener("upgrading",s)}f('probing transport "%s"',n);var c=this.createTransport(n,{probe:1}),d=!1,u=this;p.priorWebsocketSuccess=!1,c.once("open",e),c.once("error",t),c.once("close",i),this.once("close",r),this.once("upgrading",s),c.open()},p.prototype.onOpen=function(){if(f("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){f("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},p.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(f('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else f('packet received with socket readyState "%s"',this.readyState)},p.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},p.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},p.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){f("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},p.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},p.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()},p.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(f("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},p.prototype.write=p.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},p.prototype.sendPacket=function(e,t,n,o){if("function"==typeof t&&(o=t,t=void 0),"function"==typeof n&&(o=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),o&&this.once("flush",o),this.flush()}},p.prototype.close=function(){function e(){o.onClose("forced close"),f("socket closing - telling transport to close"),o.transport.close()}function t(){o.removeListener("upgrade",t),o.removeListener("upgradeError",t),e()}function n(){o.once("upgrade",t),o.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var o=this;this.writeBuffer.length?this.once("drain",function(){(this.upgrading?n:e)()}):(this.upgrading?n:e)()}return this},p.prototype.onError=function(e){f("socket error %j",e),p.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},p.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){f('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},p.prototype.filterUpgrades=function(e){for(var t=[],n=0,o=e.length;n<o;n++)~r(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){var s=n(16),a=n(18),c=n(32),o=n(33);t.polling=function(e){var t=!1,n=!1,o=!1!==e.jsonp;if("undefined"!=typeof location){var i="https:"===location.protocol,r=location.port;r=r||(i?443:80),t=e.hostname!==location.hostname||r!==e.port,n=e.secure!==i}if(e.xdomain=t,e.xscheme=n,"open"in new s(e)&&!e.forceJSONP)return new a(e);if(!o)throw new Error("JSONP disabled");return new c(e)},t.websocket=o},function(e,t,n){var i=n(17);e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(e,t,n){function o(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n=n||(t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function r(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in r.requests)r.requests.hasOwnProperty(e)&&r.requests[e].abort()}var a=n(16),c=n(19),d=n(8),u=n(30),p=n(3)("engine.io-client:polling-xhr");if(e.exports=i,e.exports.Request=r,u(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new r(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,o=this.request({method:"POST",data:e,isBinary:n}),i=this;o.on("success",t),o.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=o},i.prototype.doPoll=function(){p("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},d(r.prototype),r.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new a(e),n=this;try{p("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},p("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},r.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},r.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=o:this.xhr.onreadystatechange=o,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},r.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},r.requestsCount=0,r.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",s);else if("function"==typeof addEventListener){var f="onpagehide"in self?"pagehide":"unload";addEventListener(f,s,!1)}},function(e,t,n){function o(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(20),r=n(29),s=n(21),a=n(30),c=n(31),d=n(3)("engine.io-client:polling");e.exports=o;var u=null!=new(n(16))({xdomain:!1}).responseType;a(o,i),o.prototype.name="polling",o.prototype.doOpen=function(){this.poll()},o.prototype.pause=function(e){function t(){d("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var o=0;this.polling&&(d("we are currently polling - waiting to pause"),o++,this.once("pollComplete",function(){d("pre-pause polling complete"),--o||t()})),this.writable||(d("we are currently writing - waiting to pause"),o++,this.once("drain",function(){d("pre-pause writing complete"),--o||t()}))}else t()},o.prototype.poll=function(){d("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},o.prototype.onData=function(e){var o=this;d("polling got data %s",e);s.decodePayload(e,this.socket.binaryType,function(e,t,n){return"opening"===o.readyState&&o.onOpen(),"close"===e.type?(o.onClose(),!1):void o.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():d('ignoring poll - transport state "%s"',this.readyState))},o.prototype.doClose=function(){function e(){d("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(d("transport open - closing"),e()):(d("transport not open - deferring close"),this.once("open",e))},o.prototype.write=function(e){var t=this;this.writable=!1;function n(){t.writable=!0,t.emit("drain")}s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},o.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"==t&&443!==Number(this.port)||"http"==t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(21);n(8)((e.exports=o).prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,f,t){function a(e,t,n){if(!t)return f.encodeBase64Packet(e,n);if(p)return function(e,t,n){if(!t)return f.encodeBase64Packet(e,n);var o=new FileReader;return o.onload=function(){f.encodePacket({type:e.type,data:o.result},t,!0,n)},o.readAsArrayBuffer(e.data)}(e,t,n);var o=new Uint8Array(1);return o[0]=h[e.type],n(new g([o.buffer,e.data]))}function i(e,t,n){function o(n,e,o){t(e,function(e,t){i[n]=t,o(e,i)})}for(var i=new Array(e.length),r=c(e.length,n),s=0;s<e.length;s++)o(s,e[s],r)}var r,n=t(22),s=t(23),l=t(24),c=t(25),d=t(26);"undefined"!=typeof ArrayBuffer&&(r=t(27));var o="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),p=o||u;f.protocol=3;var h=f.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},m=n(h),v={type:"error",data:"parser error"},g=t(28);f.encodePacket=function(e,t,n,o){"function"==typeof t&&(o=t,t=!1),"function"==typeof n&&(o=n,n=null);var i,r=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(e,t,n){if(!t)return f.encodeBase64Packet(e,n);var o=e.data,i=new Uint8Array(o),r=new Uint8Array(1+o.byteLength);r[0]=h[e.type];for(var s=0;s<i.length;s++)r[s+1]=i[s];return n(r.buffer)}(e,t,o);if(void 0!==g&&r instanceof g)return a(e,t,o);if(r&&r.base64)return i=e,o("b"+f.packets[i.type]+i.data.data);var s=h[e.type];return void 0!==e.data&&(s+=n?d.encode(String(e.data),{strict:!1}):String(e.data)),o(""+s)},f.encodeBase64Packet=function(t,n){var o,i="b"+f.packets[t.type];if(void 0!==g&&t.data instanceof g){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];n(i+e)},r.readAsDataURL(t.data)}try{o=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];o=String.fromCharCode.apply(null,a)}return i+=btoa(o),n(i)},f.decodePacket=function(e,t,n){if(void 0===e)return v;if("string"==typeof e){if("b"===e.charAt(0))return f.decodeBase64Packet(e.substr(1),t);if(n&&!1===(e=function(e){try{e=d.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return v;var o=e.charAt(0);return Number(o)==o&&m[o]?1<e.length?{type:m[o],data:e.substring(1)}:{type:m[o]}:v}o=new Uint8Array(e)[0];var i=l(e,1);return g&&"blob"===t&&(i=new g([i])),{type:m[o],data:i}},f.decodeBase64Packet=function(e,t){var n=m[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&g&&(o=new g([o])),{type:n,data:o}},f.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var o=s(e);return t&&o?g&&!p?f.encodePayloadAsBlob(e,n):f.encodePayloadAsArrayBuffer(e,n):e.length?void i(e,function(e,n){f.encodePacket(e,!!o&&t,!1,function(e){var t;n(null,(t=e).length+":"+t)})},function(e,t){return n(t.join(""))}):n("0:")},f.decodePayload=function(e,t,n){if("string"!=typeof e)return f.decodePayloadAsBinary(e,t,n);var o;if("function"==typeof t&&(n=t,t=null),""===e)return n(v,0,1);for(var i,r,s="",a=0,c=e.length;a<c;a++){var d=e.charAt(a);if(":"===d){if(""===s||s!=(i=Number(s)))return n(v,0,1);if(s!=(r=e.substr(a+1,i)).length)return n(v,0,1);if(r.length){if(o=f.decodePacket(r,t,!1),v.type===o.type&&v.data===o.data)return n(v,0,1);if(!1===n(o,a+i,c))return}a+=i,s=""}else s+=d}return""!==s?n(v,0,1):void 0},f.encodePayloadAsArrayBuffer=function(e,o){return e.length?void i(e,function(e,t){f.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),s=new Uint8Array(n),a=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var o=new Uint8Array(e.length),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);n=o.buffer}s[a++]=t?0:1;var r=n.byteLength.toString();for(i=0;i<r.length;i++)s[a++]=parseInt(r[i]);s[a++]=255;for(o=new Uint8Array(n),i=0;i<o.length;i++)s[a++]=o[i]}),o(s.buffer)}):o(new ArrayBuffer(0))},f.encodePayloadAsBlob=function(e,n){i(e,function(e,a){f.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);e=n.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),r=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)r[o]=parseInt(i[o]);if(r[i.length]=255,g){var s=new g([t.buffer,r.buffer,e]);a(null,s)}})},function(e,t){return n(new g(t))})},f.decodePayloadAsBinary=function(e,n,o){"function"==typeof n&&(o=n,n=null);for(var t=e,i=[];0<t.byteLength;){for(var r=new Uint8Array(t),s=0===r[0],a="",c=1;255!==r[c];c++){if(310<a.length)return o(v,0,1);a+=r[c]}t=l(t,2+a.length),a=parseInt(a);var d=l(t,0,a);if(s)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var u=new Uint8Array(d);d="";for(c=0;c<u.length;c++)d+=String.fromCharCode(u[c])}i.push(d),t=l(t,a)}var p=i.length;i.forEach(function(e,t){o(f.decodePacket(e,n,!0),t,p)})}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var o in e)n.call(e,o)&&t.push(o);return t}},function(e,t,n){var r=n(10),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(r(t)){for(var n=0,o=t.length;n<o;n++)if(e(t[n]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0;return!1}},function(e,t){e.exports=function(e,t,n){var o=e.byteLength;if(t=t||0,n=n||o,e.slice)return e.slice(t,n);if(t<0&&(t+=o),n<0&&(n+=o),o<n&&(n=o),o<=t||n<=t||0===o)return new ArrayBuffer(0);for(var i=new Uint8Array(e),r=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)r[a]=i[s];return r.buffer}},function(e,t){function s(){}e.exports=function(e,n,o){function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(r=!0,n(e),n=o):0!==i.count||r||n(null,t)}var r=!1;return o=o||s,0===(i.count=e)?n():i}},function(e,t){function a(e){for(var t,n,o=[],i=0,r=e.length;i<r;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<r?56320==(64512&(n=e.charCodeAt(i++)))?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),i--):o.push(t);return o}function o(e,t){if(!(55296<=e&&e<=57343))return 1;if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function i(e,t){return f(e>>t&63|128)}function c(e,t){if(0==(4294967168&e))return f(e);var n="";return 0==(4294965248&e)?n=f(e>>6&31|192):0==(4294901760&e)?(o(e,t)||(e=65533),n=f(e>>12&15|224),n+=i(e,6)):0==(4292870144&e)&&(n=f(e>>18&7|240),n+=i(e,12),n+=i(e,6)),n+f(63&e|128)}function r(){if(u<=p)throw Error("Invalid byte index");var e=255&d[p];if(p++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function s(e){var t,n;if(u<p)throw Error("Invalid byte index");if(p==u)return!1;if(t=255&d[p],p++,0==(128&t))return t;if(192==(224&t)){if(128<=(n=(31&t)<<6|r()))return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(n=(15&t)<<12|r()<<6|r()))return o(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(65536<=(n=(7&t)<<18|r()<<12|r()<<6|r())&&n<=1114111))return n;throw Error("Invalid UTF-8 detected")}var d,u,p,f=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,o=a(e),i=o.length,r=-1,s="";++r<i;)s+=c(o[r],n);return s},decode:function(e,t){var n=!1!==(t=t||{}).strict;d=a(e),u=d.length,p=0;for(var o,i=[];!1!==(o=s(n));)i.push(o);return function(e){for(var t,n=e.length,o=-1,i="";++o<n;)65535<(t=e[o])&&(i+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=f(t);return i}(i)}}},function(e,t){!function(){"use strict";for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=new Uint8Array(256),e=0;e<r.length;e++)p[r.charCodeAt(e)]=e;t.encode=function(e){var t,n=new Uint8Array(e),o=n.length,i="";for(t=0;t<o;t+=3)i+=r[n[t]>>2],i+=r[(3&n[t])<<4|n[t+1]>>4],i+=r[(15&n[t+1])<<2|n[t+2]>>6],i+=r[63&n[t+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,n,o,i,r,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var d=new ArrayBuffer(s),u=new Uint8Array(d);for(t=0;t<a;t+=4)n=p[e.charCodeAt(t)],o=p[e.charCodeAt(t+1)],i=p[e.charCodeAt(t+2)],r=p[e.charCodeAt(t+3)],u[c++]=n<<2|o>>4,u[c++]=(15&o)<<4|i>>2,u[c++]=(3&i)<<6|63&r;return d}}()},function(e,t){function o(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function n(e,t){t=t||{};var n=new r;return o(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function i(e,t){return new Blob(o(e),t||{})}var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=r&&r.prototype.append&&r.prototype.getBlob;"undefined"!=typeof Blob&&(n.prototype=Blob.prototype,i.prototype=Blob.prototype),e.exports=s?a?Blob:i:c?n:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),o=0,i=n.length;o<i;o++){var r=n[o].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},function(e,t){e.exports=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function n(e){for(var t="";t=r[e%s]+t,0<(e=Math.floor(e/s)););return t}function o(){var e=n(+new Date);return e!==i?(c=0,i=e):e+"."+n(c++)}for(var i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},c=0,d=0;d<s;d++)a[r[d]]=d;o.encode=n,o.decode=function(e){var t=0;for(d=0;d<e.length;d++)t=t*s+a[e.charAt(d)];return t},e.exports=o},function(n,e,a){(function(o){function i(){}function e(e){if(r.call(this,e),this.query=this.query||{},!s){var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==o?o:{};s=t.___eio=t.___eio||[]}this.index=s.length;var n=this;s.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=i)},!1)}var r=a(19),t=a(30);n.exports=e;var s,d=/\n/g,u=/\\n/g;t(e,r),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},e.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},e.prototype.doWrite=function(e,t){function n(){o(),t()}function o(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=i.iframeId,r.src="javascript:0"}r.id=i.iframeId,i.form.appendChild(r),i.iframe=r}var i=this;if(!this.form){var r,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),o(),e=e.replace(u,"\\\n"),this.area.value=e.replace(d,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(e,function(){return this}())},function(e,t,n){function o(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(f=r),s.call(this,e)}var i,r,s=n(20),a=n(21),c=n(29),d=n(30),u=n(31),p=n(3)("engine.io-client:websocket");if("undefined"==typeof self)try{r=n(34)}catch(e){}else i=self.WebSocket||self.MozWebSocket;var f=i||r;d(e.exports=o,s),o.prototype.name="websocket",o.prototype.supportsBinary=!0,o.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new f(e,t):new f(e):new f(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},o.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},o.prototype.write=function(e){var o=this;this.writable=!1;for(var i=e.length,t=0,n=i;t<n;t++)!function(n){a.encodePacket(n,o.supportsBinary,function(e){if(!o.usingBrowserWebSocket){var t={};if(n.options&&(t.compress=n.options.compress),o.perMessageDeflate)("string"==typeof e?Buffer.byteLength(e):e.length)<o.perMessageDeflate.threshold&&(t.compress=!1)}try{o.usingBrowserWebSocket?o.ws.send(e):o.ws.send(e,t)}catch(e){p("websocket closed before onclose event")}--i||(o.emit("flush"),setTimeout(function(){o.writable=!0,o.emit("drain")},0))})}(e[t])},o.prototype.onClose=function(){s.prototype.onClose.call(this)},o.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},o.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!==Number(this.port)||"ws"==t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=c.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},o.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===o.prototype.name)}},function(e,t){},function(e,t){var o=[].indexOf;e.exports=function(e,t){if(o)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,n){"use strict";function o(e,t,n){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=n(7),s=n(8),a=n(37),c=n(38),d=n(39),u=n(3)("socket.io-client:socket"),p=n(29),f=n(23);e.exports=o;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=s.prototype.emit;s(o.prototype),o.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",d(this,"onopen")),c(e,"packet",d(this,"onpacket")),c(e,"close",d(this,"onclose"))]}},o.prototype.open=o.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},o.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},o.prototype.emit=function(e){if(l.hasOwnProperty(e))return h.apply(this,arguments),this;var t=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:f(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},o.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},o.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===i(this.query)?p.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},o.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},o.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},o.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},o.prototype.ack=function(t){var n=this,o=!1;return function(){if(!o){o=!0;var e=a(arguments);u("sending ack %j",e),n.packet({type:f(e)?r.BINARY_ACK:r.ACK,id:t,data:e})}}},o.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},o.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},o.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},o.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},o.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},o.prototype.close=o.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},o.prototype.compress=function(e){return this.flags.compress=e,this},o.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],o=(t=t||0)||0;o<e.length;o++)n[o-t]=e[o];return n}},function(e,t){"use strict";e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var o=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=o.call(arguments,2);return function(){return t.apply(e,n.concat(o.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(e.exports=n).prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}],n.c=i,n.p="",n(0);function n(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return o[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var o,i});var connection=new RTCMultiConnection;connection.socketURL="https://rtcmulticonnection.herokuapp.com:443/",connection.socketMessageEvent="video-broadcast-demo",connection.session={audio:!0,video:!0,oneway:!0},connection.sdpConstraints.mandatory={OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},connection.iceServers=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun.l.google.com:19302?transport=udp"]}],setTimeout(function(){connection.open("dsf46fe#W%^&^%FGr3$6d",function(){})},100);
